define("modules/clean/appshell/pagelet_init_hooks",["require","exports","modules/core/notify","modules/clean/web_user_action_logger","modules/core/i18n"],function(e,t,r,n,s){"use strict";function o(){window.ensemble&&window.ensemble.switchedAccounts&&(r.success(s._("You have switched to your %(account_name)s account.").format({account_name:window.ensemble.viewer.getActiveUser().displayName})),n.WebUserActionLog.log(window.ensemble.viewer.getActiveUser().userId,n.WebUserActionLogEvents.SWITCH_ACCOUNT,{}))}t.initialize_module=o}),function(){define("modules/clean/history",["external/underscore","modules/core/exception","modules/core/uri"],function(e,t,r){var assert;return assert=t.assert,(function(){var t,n,s,o,i,a,c,l,u,_,h,d,p,E,S,m,f;return t=new RegExp("#|;|\\?|:|@|&|=|\\+|\\$"),p=function(){var e,n;return void 0,e=window.location.pathname,n=window.location.search,e.search(t)!==-1&&(e=String(r({path:e}))),e+n},i=function(e,t){return String(r.parse(e).setQuery(t))},a=function(e){var t;return null==e&&(e=p()),t=e.split("?"),{url:e,path:t[0],qargs:r.parse(e).getQuery()}},c={},l={},E=p(),f=null,n="",d=function(e){return n+"/"+e.substring(n.length).split("/")[1]},m=function(e){return n=e},u=function(e){var t,r,n,s,o,i,c,l,u;if(u=E,l=a(u),o=d(l.path),o in e){for(s=l.path.substr(o.length+1),i=e[o],c=[],r=0,n=i.length;r<n;r++)t=i[r],c.push(t(s,l.qargs));return c}},_=function(){return u(c)},h=function(){return u(l)},S=function(e,t,r){var n;if(r[e])return n=r[e].indexOf(t),r[e].splice(n,1)},s=function(e,t){var r,n;if(n=d(e),r=d(t),n!==r)return h()},o=function(){var e;if(e=p(),e!==E)return s(E,e),E=e,_()},{init:function(){if(!f)return E=p(),f=setInterval(o,50)},_add_callback:function(e,t,r){return this.init(),assert("string"==typeof e,"DBHistory prefix is not a string"),assert(0===e.indexOf("/"),"DBHistory prefix must be absolute"),assert(e.substring(n.length).indexOf("/",1)===-1,"multi-component prefixes arent supported"),r[e]||(r[e]=[]),r[e].push(t)},add_callback:function(e,t,r){if(null==r&&(r=!1),this._add_callback(e,t,c),!r)return _()},remove_callback:function(e,t){return S(e,t,c)},remove_exit_callback:function(e,t){return S(e,t,l)},add_exit_callback:function(e,t){return this._add_callback(e,t,l)},fire_callbacks:function(){return _()},fire_exit_callbacks:function(){return h()},_build_url_for_state_change:function(e,t){return assert("string"==typeof e,"DBHistory path is not a string"),assert(0===e.indexOf("/"),"DBHistory path must be absolute"),assert(e.indexOf("//")===-1,"DBHistory path contains //"),i(e,t)},_pre_state_change:function(e){return e!==E&&(s(E,e),!0)},_post_state_change:function(e){if(null==e&&(e=!0),E=p(),e)return _()},replace_state:function(e,t){var r;if(r=this._build_url_for_state_change(e,t),this._pre_state_change(r)&&window.history.replaceState)return window.history.replaceState(null,null,r),this._post_state_change()},push_state:function(t,r,n){var s;if(null==n&&(n={}),n=e.defaults(n,{immediatelyRestoreState:!0}),assert(t.indexOf("?")===-1,"DBHistory path contains ?"),assert(t.indexOf("#")===-1,"DBHistory path contains #"),s=this._build_url_for_state_change(t,r),this._pre_state_change(s))return window.history.pushState(null,null,s),this._post_state_change(n.immediatelyRestoreState)},update_query_param:function(e,t){var r;return r=this.deconstruct_url(),r.qargs[e]=t,this.replace_state(r.path,r.qargs)},remove_query_param:function(e){var t;return t=this.deconstruct_url(),delete t.qargs[e],this.replace_state(t.path,t.qargs)},get_url:p,construct_url:i,deconstruct_url:a,set_base_prefix:m,URL_ESCAPE_REGEX:t}})()})}.call(this),define("modules/clean/immutability_helper",["require","exports","external/deep-freeze"],function(e,t,r){"use strict";function n(e){if(null==e)throw new TypeError("Cannot thaw null/undefined object");if(Array.isArray(e))return E.call(e);for(var t=Object.create(Object.getPrototypeOf(e)),r=Object.getOwnPropertyNames(e),n=0,s=r;n<s.length;n++){var o=s[n],i=Object.getOwnPropertyDescriptor(e,o);i&&(i.get||i.set)?(i.configurable=!0,Object.defineProperty(t,o,i)):t[o]=e[o]}return t}function s(e,t){var s=n(e);return t(s),r(s)}function o(e,t){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));return t.reduce(function(e,t){return null==e?null:e[t]},e)}function i(e,t,s){if(null==e)throw new TypeError("Object to `set` cannot be null");if(e[t]===s)return e;var o=n(e);return o[t]=s,r(o)}function a(e,t,r){return i(e,t,r(e[t]))}function c(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var n=t[0];return 1===t.length?a(e,n,r):i(e,n,c(e[n],t.slice(1),r))}function l(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var n=t[0];switch(t.length){case 1:return i(e,n,r);default:return i(e,n,l(e[n]||{},t.slice(1),r))}}function u(e,t){if(null==e||null==t)throw new TypeError("Both target and source cannot be null");var s=Object.keys(t).reduce(function(r,n){return t[n]!==e[n]&&r.push(n),r},[]);if(s.length){for(var o=n(e),i=0,a=s;i<a.length;i++){var c=a[i];Object.defineProperty(o,c,Object.getOwnPropertyDescriptor(t,c))}return r(o)}return e}function _(e,t,r){if(null==e||null==r)throw new TypeError("Both target and source cannot be null");return c(e,t,function(e){return u(e,r)})}function h(e,t,n){for(var s=[],o=3;o<arguments.length;o++)s[o-3]=arguments[o];var i=E.call(e);return i.splice.apply(i,[t,n].concat(s)),r(i)}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var s=E.call(e);return s.unshift.apply(s,t),r(s)}function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var s=E.call(e);return s.push.apply(s,t),r(s)}var E=Array.prototype.slice;t.thaw=n,t.withMutations=s,t.getIn=o,t.set=i,t.update=a,t.updateIn=c,t.setIn=l,t.merge=u,t.mergeIn=_,t.splice=h,t.unshift=d,t.push=p}),function(){define("modules/clean/profiling",["jquery","external/react","modules/clean/ajax","modules/clean/web_timing_logger"],function(e,t,r,n){var s,o,i;return s=t.DOM,i=t.createClass({render:function(){return s.div({},"Hello!")},componentDidMount:function(){return n.mark_time_to_interactive()}}),o=function(){return r.WebRequest({url:"/profiling/ajax",success:function(t){return e("#profiling-container").text(t),n.mark_time_to_interactive()}})},{hello_component:i,get_profiling_ajax_content:o}})}.call(this),define("modules/clean/react/browse/constants",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";t.BrowseActionTypes={INITIALIZE_EVERYTHING:"INITIALIZE_EVERYTHING",LOAD_PATH:"LOAD_PATH",ADD_FILES:"ADD_FILES",ADD_FILES_AND_SET_LOADING_STATE:"ADD_FILES_AND_SET_LOADING_STATE",SET_PATH:"SET_PATH",SET_USER:"SET_USER",SET_URL_PREFIX:"SET_URL_PREFIX",SET_LOADING_STATE:"SET_LOADING_STATE",SET_MOUNT_POINTS:"SET_MOUNT_POINTS",SET_TEAM_FOLDERS:"SET_TEAM_FOLDERS",CHANGE_FILES:"CHANGE_FILES",SET_SELECTION:"SET_SELECTION",SELECT_FILES_BY_FQ_PATH:"SELECT_FILES_BY_FQ_PATH",SET_SHOULD_SHOW_DELETED_FILES:"SET_SHOULD_SHOW_DELETED_FILES",SET_DROP_TARGET:"SET_DROP_TARGET",SORT_FILES:"SORT_FILES",SET_COPY_MODE:"SET_COPY_MODE",COPY_SELECTED_FILES_TO_CLIPBOARD:"COPY_SELECTED_FILES_TO_CLIPBOARD",REQUEST_NEW_FILE_NAME:"REQUEST_NEW_FILE_NAME",CANCEL_FILE_RENAME:"CANCEL_FILE_RENAME",SET_FILE_RENAME_PENDING:"SET_FILE_RENAME_PENDING",SET_FILE_RENAME_COMPLETE:"SET_FILE_RENAME_COMPLETE",REQUEST_FOLDER_NAME:"REQUEST_FOLDER_NAME",CREATE_FOLDER_PENDING:"CREATE_FOLDER_PENDING",CREATE_FOLDER_COMPLETE:"CREATE_FOLDER_COMPLETE",CANCEL_CREATE_FOLDER:"CANCEL_CREATE_FOLDER",SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:"SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE",TEAM_FOLDER_DOWNGRADE:"TEAM_FOLDER_DOWNGRADE",ADD_COMMENT_STATUS_BATCH:"ADD_COMMENT_STATUS_BATCH",ADD_FILE_JUMP_KEY_CODE:"ADD_FILE_JUMP_KEY_CODE",RESET_FILE_JUMP:"RESET_FILE_JUMP",SET_ACTIVE_TAB:"SET_ACTIVE_TAB",SET_CONTEXT_FILE:"SET_CONTEXT_FILE"},t.NewFolderCreationStates={CREATE_FOLDER_INACTIVE:"CREATE_FOLDER_INACTIVE",PENDING_INPUT:"PENDING_INPUT",SAVING_INPUT:"SAVING_INPUT"},t.LoadingStates={LOADED:"LOADED",LOADING_FIRST_PAGE:"LOADING_FIRST_PAGE",LOADING_REMAINING_PAGES:"LOADING_REMAINING_PAGES"},t.Direction={UP:"UP",DOWN:"DOWN"};(function(e){e[e.FILE=1]="FILE",e[e.FOLDER=2]="FOLDER",e[e.PACKAGE=3]="PACKAGE",e[e.SHARED_FOLDER=4]="SHARED_FOLDER",e[e.SANDBOX=5]="SANDBOX",e[e.TEAM_SHARED_FOLDER=6]="TEAM_SHARED_FOLDER",e[e.TEAM_MEMBER_FOLDER=7]="TEAM_MEMBER_FOLDER"})(t.FileTypes||(t.FileTypes={}));(function(e){e[e.ACCESS_NO_ACCESS=0]="ACCESS_NO_ACCESS",e[e.ACCESS_READER=1]="ACCESS_READER",e[e.ACCESS_WRITER=2]="ACCESS_WRITER",e[e.ACCESS_OWNER=3]="ACCESS_OWNER"})(t.NameSpaceAccess||(t.NameSpaceAccess={})),t.REACT_FILE_VIEWER_ELEMENT_ID="browse-react-file-viewer-container",t.BrowseSortFields={FILENAME:"FILENAME",MODIFIED:"MODIFIED",CATEGORY:"CATEGORY",EXTENSION:"EXTENSION",SIZE:"SIZE",SHARED_WITH:"SHARED_WITH"},t.SortDirections={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"},t.DropTargetHighlightMode={NONE:"NONE",ALL_FOLDERS:"ALL_FOLDERS",NONSELECTED_FOLDERS:"NONSELECTED_FOLDERS",NONSELECTED_NONSHARED_FOLDERS:"NONSELECTED_NONSHARED_FOLDERS",NONSELECTED_NONSHARED_NONTEAM_FOLDERS:"NONSELECTED_NONSHARED_NONTEAM_FOLDERS"};var n={IMAGE:["bmp","cr2","gif","ico","jpeg","jpg","nef","png","psd","tif","tiff","svg","svgz"],VIDEO:["3gp","3gpp","3gpp2","avi","dv","flv","m2t","m4v","mkv","mov","mp4","mpeg","mpg","mts","ts","vob","wmv"],AUDIO:["aif","flac","m4a","m4p","mp3","ogg","wav","wma"],DOCUMENT:["ai","cdr","csv","doc","docx","docm","eps","fla","indd","keynote","numbers","otf","pages","pdf","ppt","pptx","pptm","pps","ppsx","ppsm","ps","rtf","swf","txt","wpd","xls","xlsx","xlsm"],COMPRESSED_FILE:["7z","bz2","gz","gzip","rar","tar","zip"],CODE:["as","as3","asm","aspx","bat","c","cc","cmake","coffee","cpp","cs","css","cxx","diff","erb","erl","groovy","gry","h","haml","hh","hpp","html","htm","hxx","java","js","json","jsx","less","lst","m","make","mk","ml","mm","msg","out","patch","php","pl","pm","plist","properties","py","rb","sass","scala","scm","script","scss","sh","sml","sql","vb","vi","vim","xhtml","xml","xsd","xsl","y","yaml","yml","yxx"],DISK_IMAGE:["dmg","iso"],EXECUTABLE:["exe"],SHORTCUT:["lnk"],LINK:["url","webloc"],FONT:["ttf"]};t.BrowseTileGridConstants={NUM_THRESHOLD_ROWS:10,SCROLL_DELTA_THRESHOLD:1},t.CulledListConstants={ITEM_ROW_HEIGHT_PX:46,MAESTRO_ITEM_ROW_HEIGHT_PX:57,SEARCH_ROW_HEIGHT_PX:53,MAESTRO_SEARCH_ROW_HEIGHT_PX:66,DEFAULT_HEADER_HEIGHT_PX:142,ITEM_BUFFER_SIZE:5},t.ItemTypes={CREATE_FOLDER_UI:"CreateFolderUI",LOADING_INDICATOR:"LoadingIndicator"},t.FileTypeCategoryTranslations={FILE:r._("File"),FOLDER:r._("Folder"),SHARED_FOLDER:r._("Shared folder"),TEAM_SHARED_FOLDER:r._("Team folder"),TEAM_MEMBER_FOLDER:r._("Member folder"),PUBLIC_FOLDER:r._("Folder"),IMAGE:r._("Image"),VIDEO:r._("Video"),AUDIO:r._("Audio"),DOCUMENT:r._("Document"),COMPRESSED_FILE:r._("Archive"),CODE:r._("Code"),DISK_IMAGE:r._("Disk image"),EXECUTABLE:r._("Executable"),SHORTCUT:r._("Shortcut"),LINK:r._("Link"),FONT:r._("Font"),SANDBOX:r._("App folder")},t.FileTypeCapitalizedCategoryTranslations={FILE:r._("FILE"),FOLDER:r._("FOLDER"),SHARED_FOLDER:r._("SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("MEMBER FOLDER"),PUBLIC_FOLDER:r._("FOLDER"),IMAGE:r._("IMAGE"),VIDEO:r._("VIDEO"),AUDIO:r._("AUDIO"),DOCUMENT:r._("DOCUMENT"),COMPRESSED_FILE:r._("ARCHIVE"),CODE:r._("CODE"),DISK_IMAGE:r._("DISK IMAGE"),EXECUTABLE:r._("EXECUTABLE"),SHORTCUT:r._("SHORTCUT"),LINK:r._("LINK"),FONT:r._("FONT"),SANDBOX:r._("APP FOLDER")},t.DeletedFileTypeCategoryTranslations={FILE:r._("Deleted file"),FOLDER:r._("Deleted folder"),SHARED_FOLDER:r._("Deleted shared folder"),TEAM_SHARED_FOLDER:r._("Deleted team folder"),TEAM_MEMBER_FOLDER:r._("Deleted member folder"),PUBLIC_FOLDER:r._("Deleted folder"),IMAGE:r._("Deleted image"),VIDEO:r._("Deleted video"),AUDIO:r._("Deleted audio"),DOCUMENT:r._("Deleted document"),COMPRESSED_FILE:r._("Deleted archive"),CODE:r._("Deleted code"),DISK_IMAGE:r._("Deleted disk image"),EXECUTABLE:r._("Deleted executable"),SHORTCUT:r._("Deleted shortcut"),LINK:r._("Deleted link"),FONT:r._("Deleted font"),SANDBOX:r._("Deleted app folder")},t.DeletedFileTypeCapitalizedCategoryTranslations={FILE:r._("DELETED FILE"),FOLDER:r._("DELETED FOLDER"),SHARED_FOLDER:r._("DELETED SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("DELETED TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("DELETED MEMBER FOLDER"),PUBLIC_FOLDER:r._("DELETED FOLDER"),IMAGE:r._("DELETED IMAGE"),VIDEO:r._("DELETED VIDEO"),AUDIO:r._("DELETED AUDIO"),DOCUMENT:r._("DELETED DOCUMENT"),COMPRESSED_FILE:r._("DELETED ARCHIVE"),CODE:r._("DELETED CODE"),DISK_IMAGE:r._("DELETED DISK IMAGE"),EXECUTABLE:r._("DELETED EXECUTABLE"),SHORTCUT:r._("DELETED SHORTCUT"),LINK:r._("DELETED LINK"),FONT:r._("DELETED FONT"),SANDBOX:r._("DELETED APP FOLDER")},t.ExtensionCategories={};for(var s=0,o=Object.keys(n);s<o.length;s++)for(var i=o[s],a=n[i],c=0,l=a;c<l.length;c++){var u=l[c];t.ExtensionCategories[u]=i}t.RenameStates={PENDING_INPUT:"pending-input",SAVING_INPUT:"saving-input"};(function(e){e[e.NONE=-1]="NONE",e[e.LEFT=0]="LEFT",e[e.MIDDLE=1]="MIDDLE",e[e.RIGHT=2]="RIGHT"})(t.MouseEventButton||(t.MouseEventButton={}));(function(e){e[e.ShareExisting=1]="ShareExisting",e[e.EditShared=2]="EditShared",e[e.EditSharedSubFolder=3]="EditSharedSubFolder"})(t.ShareFolderModalTypes||(t.ShareFolderModalTypes={})),t.SharedWithActionTypes={SET_SHARED_FOLDER_DATA:"SET_SHARED_FOLDER_DATA",SET_MEMBER_COUNTS_FOR_NS:"SET_MEMBER_COUNTS_FOR_NS",SET_SHARED_LINK_DATA:"SET_SHARED_LINK_DATA",SET_SHARED_FILE_DATA:"SET_SHARED_FILE_DATA",SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE:"SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE",SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE:"SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE",SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE:"SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE",CLEAR_SHARED_FOLDER_DATA_FOR_NS:"CLEAR_SHARED_FOLDER_DATA_FOR_NS",REMOVE_SHARED_LINK_DATA:"REMOVE_SHARED_LINK_DATA"},t.SEARCH_PREFIX="/search",t.ViewTypes={Grid:"GRID_VIEW",List:"LIST_VIEW"}}),define("modules/clean/react/browse/models",["require","exports","tslib","external/deep-freeze","modules/clean/immutability_helper","modules/clean/filepath","modules/clean/react/browse/constants","modules/constants/legacy"],function(e,t,r,n,s,o,i,a){"use strict";var c=(function(){function e(e){this.ago=e.ago,this.beacon_context=e.beacon_context,this.bytes=e.bytes,this.comment_count=e.comment_count,this.direct_blockserver_link=e.direct_blockserver_link,this.doc_preview_status=e.doc_preview_status,this.feedback_off=e.feedback_off,this.file_id=e.file_id,this.filename_highlights=e.filename_highlights,this.fq_path=e.fq_path,this.href=e.href,this.htmlified_link=e.htmlified_link,this.icon=e.icon,this.is_dir=e.is_dir,this.is_in_team_folder_tree=e.is_in_team_folder_tree,this.is_unmounted=e.is_unmounted,this.last_modified_fname=e.last_modified_fname,this.latest_rev=e.latest_rev,this.linkfile_data=e.linkfile_data,this.match_type=e.match_type,this._mount_access_perms=e._mount_access_perms,this.ns_id=e.ns_id,this.ns_path=e.ns_path,this.preview_type=e.preview_type,this.preview_url=e.preview_url,this.preview_thumbnail_url=e.preview_thumbnail_url,this.request_id=e.request_id,this.revision_id=e.revision_id,this.size=e.size,this.sjid=e.sjid,this.sort_key=e.sort_key,this.sort_rank=e.sort_rank,this.target_ns=e.target_ns,this.team_folder_status=e.team_folder_status,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.ts=e.ts,this.type=e.type,this.unresolved_comment_count=e.unresolved_comment_count,this.video_transcode_url=e.video_transcode_url,this.preview_ssr_text_url_tmpl=e.preview_ssr_text_url_tmpl,this.preview_ssr_image_url_tmpl=e.preview_ssr_image_url_tmpl,this.isDeleted=!!e.isDeleted,n(this)}return e.fromServerObject=function(t){return new e(r.__assign({},t,{_mount_access_perms:t.mount_access_perms,isDeleted:t.bytes===-1}))},e.prototype.set=function(e,t){return s.set(this,e,t)},e.prototype.merge=function(e){return s.merge(this,e)},e.prototype.toJS=function(){return Object.assign({},this)},e.getExtension=function(e){return e.is_dir?"":o.file_extension(o.filename(e.fq_path))},e.getCategoryDescription=function(t,r){void 0===r&&(r=!1);var n;if(t.is_dir)switch(n="FOLDER",t.type){case i.FileTypes.TEAM_SHARED_FOLDER:n="TEAM_SHARED_FOLDER";break;case i.FileTypes.SHARED_FOLDER:n="SHARED_FOLDER";break;case i.FileTypes.SANDBOX:n="SANDBOX";break;case i.FileTypes.TEAM_MEMBER_FOLDER:n="TEAM_MEMBER_FOLDER";break;default:t.target_ns&&(n="SHARED_FOLDER")}else n=i.ExtensionCategories[e.getExtension(t)]||"FILE";return t.isDeleted?r?i.DeletedFileTypeCapitalizedCategoryTranslations[n]:i.DeletedFileTypeCategoryTranslations[n]:r?i.FileTypeCapitalizedCategoryTranslations[n]:i.FileTypeCategoryTranslations[n]},e.isTeamSharedFolder=function(e){return e.type===i.FileTypes.TEAM_SHARED_FOLDER},e.isTeamMemberFolder=function(e){return e.type===i.FileTypes.TEAM_MEMBER_FOLDER},e.isReadOnlySharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&t.indexOf("can_edit")<0},e.isNoAccessSharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&t.indexOf("can_view")<0},e.canViewFileMembers=function(e,t){var r=e._mount_access_perms;return!(r&&r.indexOf("can_view_members")<0)&&(!(t&&!t.canViewContainingNSMembers)||!!(r&&r.indexOf("can_view_members")>=0))},e.areEqual=function(e,t){return e.ns_id===t.ns_id&&e.sjid===t.sjid},e.revisionKey=function(e){return e.ns_id+":"+e.sjid},e})();t.File=c;var l=(function(){function e(e){void 0===e&&(e={}),this.isPublicFolderEnabled=!!e.isPublicFolderEnabled,this.publicFolderFqPath=e.publicFolderFqPath,this.publicAppToken=e.publicAppToken,Object.freeze(this)}return e.fromServerObject=function(t){return new e({isPublicFolderEnabled:t.public_folder_enabled,publicFolderFqPath:t.public_folder_fq_path,publicAppToken:t.public_app_token})},e.prototype.set=function(e,t){return s.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e})();t.Config=l;var u=(function(){function e(e){var t=void 0===e?{}:e,r=t.canViewContainingNSMembers,s=t.currentNSID,o=t.currentFQPath,c=t.currentMountPoint,u=t.currentNSPath,_=t.currentSharedFolderPermissionRole,h=t.currentNSAllowsNesting,d=t.inactiveNSIDByFQPath,p=t.permanentDeletionDisabledStateByNSID,E=t.isInFolderMode,S=t.isCurrentlyInRoot,m=t.isInsideSharedFolder,f=t.isInsideTeamFolderRoot,g=t.isInsideArchivedTeamFolder,T=t.isInsideTeamFolderTree,R=t.isInsideDeletedFolder,I=t.isInsideDeletedSharedFolder,A=t.isInsideDeletedNestedSharedFolder,D=t.isNonUserRelativeContext,O=t.pathRoot,y=t.rootNSID,C=t.showSharedFolderCreateTeamPromo,N=t.showPinnedTeamFolder,L=t.teamFolderOwnerTeamApiId,v=t.blockHash,b=t.config;this.canViewContainingNSMembers=null==r||r,this.currentNSID=s||a.root_ns_id,this.currentFQPath=o||"",this.currentMountPoint=c,this.currentNSPath=u,this.currentSharedFolderPermissionRole=null!=_?_:i.NameSpaceAccess.ACCESS_NO_ACCESS,this.currentNSAllowsNesting=!!h,this.inactiveNSIDByFQPath=d||{},this.permanentDeletionDisabledStateByNSID=p||{},this.isInFolderMode=null==E||E,this.isCurrentlyInRoot=!!S,this.isInsideSharedFolder=!!m,this.isInsideTeamFolderRoot=!!f,this.isInsideArchivedTeamFolder=!!g,this.isInsideTeamFolderTree=!!T,this.isInsideDeletedFolder=!!R,this.isInsideDeletedSharedFolder=!!I,this.isInsideDeletedNestedSharedFolder=!!A,this.isNonUserRelativeContext=!!D,this.pathRoot=O,this.rootNSID=y,this.showSharedFolderCreateTeamPromo=!!C,this.showPinnedTeamFolder=!!N,this.teamFolderOwnerTeamApiId=L,this.blockHash=v,this.config=b||new l,n(this)}return e.fromServerObject=function(t){var r=t.containing_fq_path||"";r.startsWith("/")||(r="/"+r);var n;t.inside_shared_folder&&(n=i.NameSpaceAccess.ACCESS_READER);var s,o,a=t.containing_ns_permissions||[];return o=a.indexOf("mount_shared_folders")>=0,t.inside_shared_folder&&(a.indexOf("edit_contents")>=0&&(n=i.NameSpaceAccess.ACCESS_WRITER),a.indexOf("change_folder_options")>=0&&(n=i.NameSpaceAccess.ACCESS_OWNER),a.indexOf("view_members")<0&&(s=!1)),new e({blockHash:t.block_hash,canViewContainingNSMembers:s,config:l.fromServerObject(t),currentFQPath:r,currentMountPoint:t.containing_mount_point,currentNSAllowsNesting:o,currentNSID:t.containing_ns_id,currentNSPath:t.containing_ns_path,currentSharedFolderPermissionRole:n,inactiveNSIDByFQPath:t.old_path_to_ns_id,isCurrentlyInRoot:t.in_root_dir,isInFolderMode:t.inside_dir,isInsideArchivedTeamFolder:t.inside_archived_team_folder,isInsideTeamFolderRoot:t.inside_team_folder_root,isInsideDeletedFolder:t.inside_deleted_dir,isInsideDeletedNestedSharedFolder:t.inside_deleted_nested_shared_folder,isInsideDeletedSharedFolder:t.inside_deleted_shared_folder,isInsideSharedFolder:t.inside_shared_folder,isInsideTeamFolderTree:t.inside_team_folder_tree,isNonUserRelativeContext:t.is_non_user_relative_context,pathRoot:t.path_root,permanentDeletionDisabledStateByNSID:t.permanent_delete_is_disabled_by_ns_id,rootNSID:t.root_ns_id,showPinnedTeamFolder:t.show_pinned_team_folder,showSharedFolderCreateTeamPromo:t.show_shared_folder_create_team_promo,teamFolderOwnerTeamApiId:t.team_folder_owner_team_dbtid})},e.prototype.set=function(e,t){return s.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e.prototype.isCurrentPathWriteable=function(){var e=this,t=e.currentSharedFolderPermissionRole;return!e.isInsideSharedFolder||t===i.NameSpaceAccess.ACCESS_WRITER||t===i.NameSpaceAccess.ACCESS_OWNER},e.prototype.getNameOfTargetFolder=function(){return o.filename(this.currentFQPath)},e})();t.BrowseContext=u;var _=(function(){function e(e){this.title=e.title,this.pad_id=e.pad_id,this.url=e.url,this.title_highlights=e.title_highlights,this.creator_name=e.creator_name,this.last_modified_date=e.last_modified_date,this.request_id=e.request_id,this.sort_rank=e.sort_rank,n(this)}return e.fromServerObject=function(t){return new e(t)},e})();t.Paper=_}),define("modules/clean/react/maestro/a11y_constants",["require","exports"],function(e,t){"use strict";(function(e){e[e.TITLE=0]="TITLE",e[e.SEARCH_BAR=1]="SEARCH_BAR",e[e.NOTIFICATION_BELL=2]="NOTIFICATION_BELL",e[e.ACCOUNT_MENU=3]="ACCOUNT_MENU",e[e.MAIN_CONTENT=4]="MAIN_CONTENT",e[e.SIDE_BAR=5]="SIDE_BAR"})(t.LAYOUT_TAB_ORDER||(t.LAYOUT_TAB_ORDER={}))}),define("modules/clean/react/maestro/header",["require","exports","tslib","external/react","external/mcl/vertically_fixed","modules/clean/react/css","modules/clean/react/maestro/top_menu_container","modules/clean/react/image","modules/clean/static_urls","modules/clean/react/maestro/a11y_constants"],function(e,t,r,n,s,o,i,a,c,l){"use strict";var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.createElement("header",{className:"maestro-header page-header__shadow"},n.createElement(s.VerticallyFixed,{className:"page-header"},n.createElement("div",{className:"page-header__title",tabIndex:l.LAYOUT_TAB_ORDER.TITLE},this.props.title),n.createElement(i.TopMenuContainer,{user:this.props.user,showSearchBar:this.props.showSearchBar,currentPath:this.props.currentPath,onSearch:this.props.onSearch,onFileOrFolderOpen:this.props.onFileOrFolderOpen,limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,trademarkBusiness:this.props.trademarkBusiness})))},t})(n.Component);u.defaultProps={showSearchBar:!0};var _=function(e){var t=e.children;return n.createElement("h1",{className:"page-header__heading"},t)};t.MaestroHeaderTitle=_;var h=function(){return n.createElement("a",{href:"/",className:"page-header__logo"},n.createElement(a,{src:c.static_url("/static/images/header_logo-vflzsBFzu.png"),srcHiRes:c.static_url("/static/images/header_logo@2x-vflt21Kis.png"),alt:"Dropbox"}))};t.MaestroHeaderLogo=h;var d=o(u,["/static/css/maestro_header-vfl-1yEEy.css"]);t.PageletMaestroHeader=d}),define("modules/clean/react/maestro/layout",["require","exports","tslib","external/react","modules/clean/react/maestro/header","modules/clean/react/maestro/secondary_sidebar","modules/clean/react/maestro/a11y_constants"],function(e,t,r,n,s,o,i){"use strict";function a(e){var t=e.user,a=e.titleRegion,c=e.embeddedAppRegion,l=e.actionSidebarRegion,u=e.searchBarProps,_=null;return null!=l&&(_=n.createElement("div",{className:"maestro-secondary-sidebar__shadow",tabIndex:i.LAYOUT_TAB_ORDER.SIDE_BAR},n.createElement(o.MaestroSecondarySidebar,null,l))),n.createElement("div",{className:"maestro-chrome"},n.createElement(s.PageletMaestroHeader,r.__assign({user:t,title:a},u||{})),n.createElement("main",{className:"maestro-app"},n.createElement("div",{className:"maestro-app-content",tabIndex:i.LAYOUT_TAB_ORDER.MAIN_CONTENT},c),_))}t.MaestroChrome=a}),define("modules/clean/react/maestro/profiling_blank_embedded_app",["require","exports","tslib","external/react","modules/clean/react/maestro/layout","modules/clean/profiling","modules/clean/react/maestro/header","modules/clean/viewer","modules/clean/web_timing_logger"],function(e,t,r,n,s,o,i,a,c){"use strict";var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=a.get_viewer(),t=e.get_user_by_id(this.props.uid);return n.createElement(s.MaestroChrome,{user:t,titleRegion:n.createElement(i.MaestroHeaderTitle,null,"Blank App"),embeddedAppRegion:n.createElement(o.hello_component,null)})},t.prototype.componentWillMount=function(){c.log_js_modules_application_code_start()},t})(n.Component);t.BlankEmbeddedApp=l}),define("modules/clean/react/maestro/secondary_sidebar",["require","exports","tslib","external/react","external/mcl/vertically_fixed","modules/clean/react/prompt/legacy_ha_wrapper"],function(e,t,r,n,s,o){"use strict";var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.createElement(s.VerticallyFixed,{className:"maestro-secondary-sidebar"},this.props.children,n.createElement(o.LegacyHAWrapper,null))},t})(n.Component);t.MaestroSecondarySidebar=i}),define("modules/clean/react/maestro/top_menu_container",["require","exports","tslib","external/react","modules/clean/react/browse/models","modules/core/browser","modules/clean/search/search_bar","modules/clean/search/search_helpers","modules/core/uri","modules/clean/react/css"],function(e,t,r,n,s,o,i,a,c,l){"use strict";var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSearch=function(e,r){var n=new c({path:"/search/"+t.props.user.role});e&&o.redirect(n.updateQuery({path:t.props.currentPath,query:e,qsid:r}).toString())},t.onFileOrFolderOpen=function(e){if(e instanceof s.File)if(a.logSearchAction(e,t.props.user,e.is_dir?"folder_open":"file_view","top-menu-dropdown-view"),e.is_dir)o.open_tab(e.href);else{var r=e.fq_path.substring(1),n=new c({path:"/"+t.props.user.role}).updateQuery({preview:r});o.open_tab(n.toString())}else e instanceof s.Paper&&(a.logPaperSearchAction(e,t.props.user,"paper_open","top-menu-dropdown-view"),o.open_tab(e.url))},t}return r.__extends(t,e),t.prototype.renderSearchBar=function(){return this.props.showSearchBar?n.createElement(i.SearchBar,{user:this.props.user,currentPath:this.props.currentPath,onSearch:this.props.onSearch||this.onSearch,onCancelSearch:this.props.onCancelSearch,onFileOrFolderOpen:this.props.onFileOrFolderOpen||this.onFileOrFolderOpen,limitedTeamBannerUpsell:this.props.limitedTeamBannerUpsell,trademarkBusiness:this.props.trademarkBusiness}):null},t.prototype.renderRightContent=function(){return this.props.rightContent?this.props.rightContent:n.createElement("div",{className:"top-menu-container--search-bar-empty-space"})},t.prototype.render=function(){return n.createElement("div",{className:"top-menu-container "+this.props.classNames},this.renderSearchBar(),this.renderRightContent())},t})(n.Component);u.defaultProps={showSearchBar:!0,currentPath:"/"},t.TopMenuContainer=l(u,["/static/css/pagelet-vflMB9YDo.css"],[i.SearchBar])}),function(){define("modules/clean/react/outside_event",["external/react","external/underscore","modules/clean/react/util"],function(e,t,r){var n,s,o,i,a;return a=r.mergeProps,i=e.createElement,e.DOM,o=function(r,n,s,o){var c,l,u;return c=null!=(u=r.displayName)?u:"UnnamedComponent",e.createClass({displayName:"Outside"+n+"Handled"+c,propTypes:(l={},l[""+s]=e.PropTypes.func,l[""+o]=e.PropTypes.func,l),componentDidMount:function(){return document.addEventListener(n,this._handleOutsideEvent,!1)},componentWillUnmount:function(){return document.removeEventListener(n,this._handleOutsideEvent,!1)},render:function(){var e,n;return n=a(t.omit(this.props,s,o,"children"),(e={},e[""+s]=this._handleInsideEvent,e)),i(r,n,this.props.children)},_handleOutsideEvent:function(e){var t;return"function"==typeof(t=this.props)[o]?t[o](e):void 0},_handleInsideEvent:function(e){var t,r;return e.stopPropagation(),"function"==typeof(t=e.nativeEvent).stopImmediatePropagation&&t.stopImmediatePropagation(),"function"==typeof(r=this.props)[s]?r[s](e):void 0}})},n=o("div","click","onClick","onOutsideClick"),s=o("div","mousedown","onMouseDown","onOutsideMouseDown"),{OutsideClickHandler:n,OutsideMouseDownHandler:s,addOutsideEventHandling:o}})}.call(this),define("modules/clean/react/prompt/legacy_ha_wrapper",["require","exports","tslib","external/react","modules/clean/upsell/prompt_event_emitter"],function(e,t,r,n,s){"use strict";var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.emitUpdateEvent=function(){s.Emitter.emit(s.Events.REACT_HA_DID_UPDATE)},t.prototype.componentDidMount=function(){t.emitUpdateEvent()},t.prototype.componentDidUpdate=function(){t.emitUpdateEvent()},t.prototype.render=function(){return n.createElement("div",null)},t})(n.Component);o.displayName="LegacyHAWrapper",t.LegacyHAWrapper=o}),function(){var e=[].slice,t={}.hasOwnProperty;define("modules/clean/react/selectable_list",["jquery","external/underscore","external/react","external/react-dom","external/immutable","external/keymaster","modules/clean/keycode","modules/clean/react/outside_event","modules/core/browser","modules/core/exception","modules/clean/react/helpers"],function(r,n,s,o,i,a,c,l,u,_,h){var d,p,E,S,m,f,g,assert,T,R,I,A;return c.KeyCode,g=l.addOutsideEventHandling,assert=_.assert,A=h.shallowCompareStateAndProps,S="",f=i.Record({selected:new i.OrderedSet,anchor:null}),R=function(e,t){return null==e&&(e=[]),null==t&&(t=null),new f({selected:new i.OrderedSet(e),anchor:t||e[0]})},E="up",p="down",I=function(e){return u.mac&&e.metaKey||!u.mac&&e.ctrlKey},function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],function(){var e,r,s,o;for(o=[],r=0,s=t.length;r<s;r++)e=t[r],n.isFunction(e)&&o.push(e.apply(this,arguments));return o}},m={onMouseEnter:"handleMouseEnterRow",onMouseDown:"handleMouseDownInRow",onMouseUp:"handleMouseUpInRow",onToggleRowSelected:"handleToggleRowSelected",onFocus:"handleInitialTab"},d={onMouseDown:"handleMouseDownInCheckbox",onToggleRowSelected:"handleToggleRowSelected",onMouseEnter:"noop",onMouseUp:"noop"},function(){var e;return"INPUT"===(e=document.activeElement.tagName)||"TEXTAREA"===e||"SELECT"===e||"BUTTON"===e},T=function(e,c){var l,_;return _=null!=(l=(null!=c?c:{}).shouldComponentUpdate)?l:A,e=g(e,"mouseup","onMouseUp","onOutsideMouseUp"),s.createClass({displayName:"Selectable"+e.displayName,propTypes:{allItemIds:s.PropTypes.instanceOf(i.List),onSelectionChange:s.PropTypes.func,selection:s.PropTypes.instanceOf(f),defaultSelection:s.PropTypes.instanceOf(f),keyScope:s.PropTypes.string,linkedOutsideClasses:s.PropTypes.array,addTabbingClassWhenKeyboardNavigating:s.PropTypes.bool,isCheckboxes:s.PropTypes.bool},getDefaultProps:function(){return{onSelectionChange:n.noop,selection:null,defaultSelection:new f,keyScope:"SelectableList",linkedOutsideClasses:[],addTabbingClassWhenKeyboardNavigating:!0}},getInitialState:function(){return{selection:this.props.defaultSelection}},
componentWillMount:function(){return this._focusedItem=null,this._handlerCache={},this._isFocused=!1,this._keepFocusOnToggle=!1,this._mostRecentMousedownTarget=null,this._isSelecting=!1},componentDidMount:function(){return this._setupKeyboardShortcuts(),this._focusItem(this._selection().anchor),r(o.findDOMNode(this)).on("focusin.SelectableList",this.getFocusHandler(!0)).on("focusout.SelectableList",this.getFocusHandler(!1))},shouldComponentUpdate:_,componentDidUpdate:function(e,t){var r,n;if((null!=(r=e.selection)?r.anchor:void 0)!==(null!=(n=this.props.selection)?n.anchor:void 0)&&this._selection().selected.size&&(this._focusedItem=this._selection().anchor),this._focusedItem)return this._focusItem(this._focusedItem),this._focusedItem=null},componentWillUnmount:function(){return this._handlerCache=null,S!==this.props.keyScope&&(a.clearScope(this.props.keyScope),a.setScope(S)),r(o.findDOMNode(this)).off(".SelectableList")},getFocusHandler:function(e){return(function(t){return function(){return t._isFocused=e,!0}})(this)},_setupKeyboardShortcuts:function(){var e,t,r,n,s,i,c,l,_;return S=a.getScope(),S!==this.props.keyScope&&a.setScope(this.props.keyScope),i=(function(e){return function(t){return e._isFocused&&"BUTTON"!==t.target.tagName}})(this),s=(function(e){return function(t){return!document.activeElement||document.activeElement===document.body||o.findDOMNode(e).contains(t.target)&&"INPUT"!==t.target.nodeName}})(this),n=function(e,t){return function(r){return e(r)?(r.preventDefault(),t(r)):null}},_=(function(e){return function(){return e._selectNeighboringItem({direction:E})}})(this),r=(function(e){return function(){return e._extendSelectionRange({direction:E})}})(this),l=(function(e){return function(){return e._selectNeighboringItem({direction:p})}})(this),t=(function(e){return function(){return e._extendSelectionRange({direction:p})}})(this),c=(function(e){return function(){return e._selectAllItems()}})(this),e=(function(e){return function(){return e._deselectAllItems()}})(this),a("up",this.props.keyScope,n(s,_)),a("shift+up",this.props.keyScope,n(s,r)),a("down",this.props.keyScope,n(s,l)),a("shift+down",this.props.keyScope,n(s,t)),a("escape",this.props.keyScope,n(s,e)),u.mac?a("command+a",this.props.keyScope,n(i,c)):a("ctrl+a",this.props.keyScope,n(i,c))},_focusItem:function(e){var t;if(t=this.refs[e],t&&!this._keepFocusOnToggle)return Promise.resolve().then(function(){return o.findDOMNode(t).focus()})},_itemIds:function(){var e;return this.props.allItemIds?this.props.allItemIds:(e=[],s.Children.forEach(this.props.children,function(t){var r;return(null!=t&&null!=(r=t.props)?r.selectableListId:void 0)?e.push(t.props.selectableListId):(null!=t?t.key:void 0)?e.push(t.key):void 0}),i.List(e))},_selection:function(){return this.props.selection?this.props.selection:this.state.selection},_updateState:function(e,t){if(null==t&&(t=!1),this._keepFocusOnToggle=t,this.setState({isSelecting:!1}),!i.is(this._selection(),e))return this.props.selection||this.setState({selection:e}),this.props.onSelectionChange(e)},_selectAllItems:function(){return this.setSelectedItems({itemIds:this._itemIds().toArray()})},_deselectAllItems:function(){if(this.setSelectedItems({itemIds:[]}),o.findDOMNode(this).contains(document.activeElement))return document.activeElement.blur()},_toggleItemSelected:function(e){var t,r,n,s,o,i,a,c,l,u,_,h;if(n=e.itemId,a=e.keepFocusOnToggle,h=this._selection(),h.selected.has(n)){for(h=h.update("selected",(function(e){return function(t){return e.setState({isSelecting:!0}),t.delete(n)}})(this)),c=null,t=this._itemIds().indexOf(n),r=o=l=t+1,u=this._itemIds().count();l<=u?o<u:o>u;r=l<=u?++o:--o)if(s=this._itemIds().get(r),h.selected.has(s)){c=s;break}if(!c)for(r=i=_=t-1;_<=0?i<=0:i>=0;r=_<=0?++i:--i)if(s=this._itemIds().get(r),h.selected.has(s)){c=s;break}c||(c=this._itemIds().get(0)),h=h.set("anchor",c)}else h=h.update("selected",(function(e){return function(t){return e.setState({isSelecting:!0}),t.add(n)}})(this)).set("anchor",n);return this._updateState(h,a)},_selectItemsInRangeTo:function(e){var t,r,n,s,o,i,a,c,l,u,_,h,d;if(i=e.itemId,h=this._selection(),t=null!=(u=h.anchor)?u:this._itemIds().get(0))return r=this._itemIds().indexOf(t),l=this._itemIds().indexOf(i),_=this._rangeOfSelectedBlockSurrounding(t),d=_.startIndex,n=_.endIndex,a=function(){var e,t,r,i;for(r=this._itemIds().toArray(),i=[],o=e=0,t=r.length;e<t;o=++e)s=r[o],d<=o&&o<=n&&i.push(s);return i}.call(this),c=function(){var e,t,n,i;for(n=this._itemIds().toArray(),i=[],o=e=0,t=n.length;e<t;o=++e)s=n[o],(l<=o&&o<=r||r<=o&&o<=l)&&i.push(s);return i}.call(this),l<r&&c.reverse(),h=h.update("selected",(function(e){return function(t){return e.setState({isSelecting:!0}),t.subtract(a).union(c)}})(this)),this._updateState(h)},_selectNeighboringItem:function(e){var t,n,s,o;if(t=e.direction,s=this._itemIds().indexOf(this._selection().selected.last()),n=0,t===E?n=Math.max(0,s-1):t===p&&(n=Math.min(this._itemIds().count()-1,s+1)),o=this._itemIds().get(n),this._focusedItem=o,this.setSelectedItems({itemIds:[o]}),this.props.addTabbingClassWhenKeyboardNavigating)return r(document.body).addClass("tabbing")},_extendSelectionRange:function(e){var t,n,s,o,i,a,c,l,u;if(s=e.direction,l=i=this._selection(),t=null!=(a=l.anchor)?a:this._itemIds().get(0))return n=this._itemIds().indexOf(t),c=this._rangeOfSelectedBlockSurrounding(t),u=c.startIndex,o=c.endIndex,this.setState({isSelecting:!0}),s===E?n===o?u-1>=0&&(l=l.update("selected",(function(e){return function(t){return t.add(e._itemIds().get(u-1))}})(this))):l=l.update("selected",(function(e){return function(t){return t.delete(e._itemIds().get(o))}})(this)):s===p&&(n===u||n!==o?o+1<this._itemIds().count()&&(l=l.update("selected",(function(e){return function(t){return t.add(e._itemIds().get(o+1))}})(this))):l=l.update("selected",(function(e){return function(t){return t.delete(e._itemIds().get(u))}})(this))),l!==i&&(this._focusedItem=l.selected.last(),this._updateState(l)),this.props.addTabbingClassWhenKeyboardNavigating?r(document.body).addClass("tabbing"):void 0},_rangeOfSelectedBlockSurrounding:function(e){var t,r,n,s;for(r=this._itemIds().indexOf(e);;)if(s=r,r-=1,r<0||!this._selection().selected.has(this._itemIds().get(r)))break;for(r=s;;){if(n=this._itemIds().get(r),null==n||!this._selection().selected.has(n))break;t=r,r+=1}return{startIndex:s,endIndex:t}},setSelectedItems:function(e){var t,r,n;return r=e.itemIds,this.setState({isSelecting:!0}),n=this._selection().set("selected",i.OrderedSet(r)),t=r.length>0?r[0]:this._itemIds().get(0),this._updateState(n.set("anchor",t))},handleMouseEnterRow:function(e,t){if(this._isSelecting)return this._selectItemsInRangeTo({itemId:e})},handleMouseDownInRow:function(e,t){return 2===t.button?void(this._selection().selected.has(e)||this.setSelectedItems({itemIds:[e]})):t.shiftKey?void this._selectItemsInRangeTo({itemId:e}):I(t)?void this._toggleItemSelected({itemId:e}):(this._selection().selected.has(e)||(this.setSelectedItems({itemIds:[e]}),this._isSelecting=!0),this._mostRecentMousedownTarget=e)},handleMouseUpInRow:function(e,t,r){return e===this._mostRecentMousedownTarget&&this.setSelectedItems({itemIds:[e]}),this._isSelecting=!1},handleInitialTab:function(e){if(this._itemIds().first()===e&&!this._selection().selected.has(e)&&!this.state.isSelecting)return this.setSelectedItems({itemIds:[e]})},handleToggleRowSelected:function(e,t){return(null!=t?t.shiftKey:void 0)?void this._selectItemsInRangeTo({itemId:e}):this._toggleItemSelected({itemId:e,keepFocusOnToggle:!0})},handleOutsideMouseUp:function(e){var t;if(this._isSelecting=!1,this._mostRecentMousedownTarget=null,t=o.findDOMNode(this),!t.contains(e.target)&&!r(e.target).closest(this.props.linkedOutsideClasses.join()).length&&!this._mostRecentMousedownTarget)return this._deselectAllItems()},handleMouseDownInCheckbox:function(e,t){return t.shiftKey?void this._selectItemsInRangeTo({itemId:e}):this._toggleItemSelected({itemId:e})},noop:function(e,t){},render:function(){var r,o,i,a;return o=this._handlerCache,this._handlerCache={},r=s.Children.map(this.props.children,(function(e){return function(r){var i,a,c,l,u,_,h,p,E;if(!(null!=r&&null!=(h=r.props)?h.selectableListId:void 0)&&!(null!=r?r.key:void 0))return r;_=null!=(p=null!=r&&null!=(E=r.props)?E.selectableListId:void 0)?p:r.key,l={},u=e.props.isCheckboxes?d:m;for(c in u)t.call(u,c)&&(a=u[c],assert(!r.props[c],"SelectableList does not support children having seperate "+c+" listeners"),i=c+_,l[c]=o[i]||e[a].bind(e,_),e._handlerCache[i]=l[c]);return s.cloneElement(r,n.extend(l,{ref:_,isSelected:e._selection().selected.has(_)}))}})(this)),i=Object.keys(this.constructor.propTypes),a=n.extend({},n.omit(this.props,i),{selection:this._selection(),onOutsideMouseUp:this.props.isCheckboxes?n.noop():this.handleOutsideMouseUp}),s.createElement(e,a,r)}})},{createSelectableList:T,createSelection:R}})}.call(this),define("modules/clean/search/actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/search/constants","modules/clean/search/api","modules/clean/search/store"],function(e,t,r,n,s,o){"use strict";var i=(function(){function e(e,t){void 0===e&&(e=s.searchApiClient),void 0===t&&(t=o.searchStore),this._searchApi=e,this._searchStore=t}return e.prototype.focusSearchBar=function(){r.dispatch({type:n.FOCUS_SEARCH_BAR_ACTION})},e.prototype.blurSearchBar=function(){r.dispatch({type:n.BLUR_SEARCH_BAR_ACTION})},e.prototype.setSearchQuery=function(e){var t=this,s=e.nsid,o=e.path,i=e.query,a=e.user;i!==this._searchStore.rawQuery()&&(this._searchApi.abortPreviousLoading(),r.dispatch({type:n.SET_SEARCH_QUERY_ACTION,data:{query:i}}),this._searchStore.isSearchBarLoading()&&this._searchApi.loadSuggestions({user:a,nsid:s,path:o,query:this._searchStore.normalizedQuery(),onSuccess:function(e){var r=e.searchResults;i===t._searchStore.rawQuery()&&t.setSearchSuggestions({searchResults:r})}}))},e.prototype.setSearchSuggestions=function(e){var t=e.searchResults;r.dispatch({type:n.SET_SEARCH_SUGGESTIONS_ACTION,data:{searchResults:t}})},e.prototype.setHighlightedRow=function(e){var t=e.index;r.dispatch({type:n.SET_HIGHLIGHTED_ROW_ACTION,data:{index:t}})},e.prototype.highlightPreviousRow=function(){r.dispatch({type:n.HIGHLIGHT_PREVIOUS_ROW_ACTION})},e.prototype.highlightNextRow=function(){r.dispatch({type:n.HIGHLIGHT_NEXT_ROW_ACTION})},e.prototype.runSearch=function(e){var t=this,s=e.user,o=e.path,i=e.query,a=e.qsid,c=e.logOnceFetchedDataRequiredForTTI;r.dispatch({type:n.START_SEARCH_ACTION,data:{query:i,qsid:a}}),this._searchApi.loadResults({user:s,path:o,query:i,loadDeleted:!1,start:0,onSuccess:function(e){var r=e.searchResults,n=e.context;"function"==typeof c&&c(),t._setSearchResults({searchResults:r,context:n}),t._loadDeletedResults({path:o,user:s})}})},e.prototype.loadMoreResults=function(e){var t,s=this,o=e.path,i=e.user;if(this._searchStore.loadingState()===n.SearchLoadingStates.LOADED){if(this._searchStore.hasMoreResults())t=!1;else{if(!this._searchStore.hasMoreResults(!0))return;t=!0}r.dispatch({type:n.CONTINUE_SEARCH_ACTION,data:{didLoadDeletedResults:t}}),this._searchApi.loadResults({user:i,path:o,query:this._searchStore.latestQuery(),loadDeleted:t,start:t?this._searchStore.numDeletedResults():this._searchStore.searchResults().size,onSuccess:function(e){var t=e.searchResults,r=e.context,n=e.deleted;s._appendSearchResults({searchResults:t,context:r,deleted:n}),s._loadDeletedResults({path:o,user:i})}})}},e.prototype._setSearchResults=function(e){var t=e.searchResults,s=e.context;r.dispatch({type:n.SET_SEARCH_RESULTS_ACTION,data:{searchResults:t,context:s}})},e.prototype._appendSearchResults=function(e){var t=e.searchResults,s=e.context,o=e.deleted;r.dispatch({type:n.APPEND_SEARCH_RESULTS_ACTION,data:{searchResults:t,context:s,deleted:o}})},e.prototype._loadDeletedResults=function(e){var t=e.path,r=e.user;this._searchStore.hasMoreResults()||this._searchStore.didLoadDeletedResults()||this.loadMoreResults({path:t,user:r})},e.prototype.setSearchSelection=function(e){var t=e.selection;r.dispatch({type:n.SET_SEARCH_SELECTION_ACTION,data:{selection:t}})},e.prototype.removeSearchResults=function(e){var t=e.fq_paths,s=t.map(function(e){return{before:e,after:null}}).toArray();r.dispatch({type:n.CHANGE_FILES_ACTION,data:{fileDeltas:s}})},e.prototype.clearSearch=function(){r.dispatch({type:n.CLEAR_SEARCH_ACTION})},e})();t.SearchActions=i,t.searchActions=new i}),define("modules/clean/search/api",["require","exports","modules/clean/ajax","modules/clean/analytics","modules/clean/react/browse/models","modules/clean/search/constants","modules/clean/search/search_type","modules/clean/search/types","modules/clean/search/store"],function(e,t,r,n,s,o,i,a,c){"use strict";var l=(function(){function e(){this._activeRequest=null}return e.prototype.loadSuggestions=function(e){var t=e.user,r=e.nsid,n=e.path,s=e.query,i=e.onSuccess,a=e.onError,l=c.searchStore.browseContext().isNonUserRelativeContext,u={query:s,fq_path:n,filename_only:!0,max_results:o.MaxResults.MAX_SEARCH_SUGGESTIONS,show_paper_results:!l,show_unmounted_results:!0,ns_id:r,is_admin_console:l,is_dropdown:!0,start:0};this._fetchResults(u,t,!1,i,a)},e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype.loadResults=function(e){var t=e.user,r=e.path,n=e.query,s=e.loadDeleted,i=e.start,a=e.onSuccess,c=e.onError,l={query:n,fq_path:r,filename_only:!1,max_results:o.MaxResults.MAX_SEARCH_RESULTS,deleted:s,start:i,show_paper_results:!0,show_unmounted_results:!0};this._fetchResults(l,t,s,a,c)},e.prototype._extractBrowseContext=function(e){return new s.BrowseContext({isInFolderMode:e.inside_dir,inactiveNSIDByFQPath:e.old_path_to_ns_id,permanentDeletionDisabledStateByNSID:e.permanent_delete_is_disabled_by_ns_id})},e.prototype._extractSearchResultsList=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var o=n[r];switch(o.search_result_type){case a.SearchResultTypes.FILE:t.push(s.File.fromServerObject(o));break;case a.SearchResultTypes.PAPER:t.push(s.Paper.fromServerObject(o))}}return t},e.prototype._getSearchType=function(e){return e.is_dropdown?i.SearchType.COMPLETION:e.deleted?i.SearchType.DELETED:i.SearchType.FULLTEXT},e.prototype._fetchResults=function(e,t,s,o,i){var a=this;null!=this._activeRequest&&this._activeRequest.abort();var l={firefly:!0,path_scoped:!1,search_type:this._getSearchType(e),query_string:e.query,infinite_scroll:e.start>0,search_session_id:c.searchStore.searchSessionID()};n.SearchClientActivityLogger.log("query_started",t.id,l);var u=(new Date).getTime();this._activeRequest=r.WebRequest({url:"/ajax_fulltext_search",data:e,dataType:"json",subject_user:t,success:function(r,i,_){var h=a._extractBrowseContext(r),d=r.search_results,p=_.getResponseHeader("x-dropbox-request-id");d.forEach(function(e){return e.request_id=p});var E=!!d.find(function(e){return e.used_spellcorrect}),S=a._extractSearchResultsList(d);o({context:h,searchResults:S,deleted:s}),l=n.SearchClientActivityLogger.create_completion_log_dict(l,E,p,u,e.query,!0,S.length,null,c.searchStore.searchSessionID()),n.SearchClientActivityLogger.log("query_completed",t.id,l)},error:function(e,r,s){"abort"!==r&&"function"==typeof i&&i(s);var o=e.getResponseHeader("x-dropbox-request-id");l=n.SearchClientActivityLogger.create_completion_log_dict(l,null,o,u,null,null,null,r,c.searchStore.searchSessionID()),n.SearchClientActivityLogger.log("query_failed",t.id,l)},complete:function(){this._activeRequest=null}})},e})();t.SearchApiClient=l,t.searchApiClient=new l}),define("modules/clean/search/constants",["require","exports"],function(e,t){"use strict";t.MaxResults={MAX_SEARCH_SUGGESTIONS:8,MAX_SEARCH_RESULTS:100},t.FOCUS_SEARCH_BAR_ACTION="search__FOCUS_SEARCH_BAR",t.BLUR_SEARCH_BAR_ACTION="search__BLUR_SEARCH_BAR",t.SET_SEARCH_QUERY_ACTION="search__SET_SEARCH_QUERY",t.SET_SEARCH_SUGGESTIONS_ACTION="search__SET_SEARCH_SUGGESTIONS",t.SET_HIGHLIGHTED_ROW_ACTION="search__SET_HIGHLIGHTED_ROW",t.HIGHLIGHT_PREVIOUS_ROW_ACTION="search__HIGHLIGHT_PREVIOUS_ROW",t.HIGHLIGHT_NEXT_ROW_ACTION="search__HIGHLIGHT_NEXT_ROW",t.START_SEARCH_ACTION="search__START_SEARCH",t.SET_SEARCH_RESULTS_ACTION="search__SET_SEARCH_RESULTS",t.CONTINUE_SEARCH_ACTION="search__CONTINUE_SEARCH",t.APPEND_SEARCH_RESULTS_ACTION="search__APPEND_SEARCH_RESULTS",t.CLEAR_SEARCH_ACTION="search__CLEAR_SEARCH",t.SET_SEARCH_SELECTION_ACTION="search__SET_SEARCH_SELECTION",t.CHANGE_FILES_ACTION="search__CHANGE_SEARCH_FILES",t.SearchLoadingStates={LOADED:"LOADED",LOADING_FIRST_PAGE:"LOADING_FIRST_PAGE",LOADING_ADDITIONAL_PAGE:"LOADING_ADDITIONAL_PAGE"}}),define("modules/clean/search/search_bar",["require","exports","tslib","external/classnames","external/mcl/icon_global","external/react","jquery","modules/clean/analytics","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/keycode","modules/clean/react/button","modules/clean/react/css","modules/clean/react/maestro/a11y_constants","modules/clean/react/sprite","modules/clean/react_format","modules/clean/search/actions","modules/clean/search/search_helpers","modules/clean/search/store","modules/core/accessible_announce","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,r,n,s,o,i,a,c,l,u,_,h,d,p,E,S,m,f,g,T,R,I){"use strict";var A=(function(e){function t(t){var r=e.call(this,t)||this;return r._onSearchStoreChanged=function(){r.setState(r._get_state_from_store())},r._handleInputChange=function(e){r._setSearchQuery(e.currentTarget.value)},r._handleCancelSearch=function(){r._setSearchQuery("")},r._handleInputKeydown=function(e){if(e.keyCode===u.KeyCode.ESC)return r._handleCancelSearch(),void r.props.onCancelSearch();e.stopPropagation(),e.keyCode===u.KeyCode.UP?(e.preventDefault(),S.searchActions.highlightPreviousRow()):e.keyCode===u.KeyCode.DOWN&&(e.preventDefault(),S.searchActions.highlightNextRow())},r._handleInputSubmit=function(e,t){e.preventDefault(),0===t?r.props.onSearch(r.state.normalizedQuery,f.searchStore.searchSessionID()):r.props.onFileOrFolderOpen(f.searchStore.searchSuggestions()[t-1])},r._handleHighlightDropdownItem=function(e){S.searchActions.setHighlightedRow({index:e})},r._setSearchBarRef=function(e){return r._searchBarView=e},r.state=r._get_state_from_store(),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){f.searchStore.add_change_listener(this._onSearchStoreChanged)},t.prototype.componentWillUnmount=function(){f.searchStore.remove_change_listener(this._onSearchStoreChanged)},t.prototype._get_state_from_store=function(){return{isFocused:f.searchStore.isSearchBarFocused(),isActive:f.searchStore.isSearchBarActive(),isSearchActive:!!f.searchStore.latestQuery(),rawQuery:f.searchStore.rawQuery(),normalizedQuery:f.searchStore.normalizedQuery(),suggestions:f.searchStore.searchSuggestions(),searchBarLoading:f.searchStore.isSearchBarLoading(),isAdminConsole:f.searchStore.browseContext().isNonUserRelativeContext}},t.prototype.getSearchBarView=function(){return this._searchBarView},t.prototype._setSearchQuery=function(e){S.searchActions.setSearchQuery({nsid:this.props.currentNSID,path:this.props.currentPath,query:e,user:this.props.user})},t.prototype.render=function(){return o.createElement(D,r.__assign({},this.props,this.state,{onInputChange:this._handleInputChange,onInputKeydown:this._handleInputKeydown,onInputSubmit:this._handleInputSubmit,onSearchBarFocus:S.searchActions.focusSearchBar,onSearchBarBlur:S.searchActions.blurSearchBar,onHighlightDropdownItem:this._handleHighlightDropdownItem,ref:this._setSearchBarRef,highlightedRow:f.searchStore.highlightedSearchRow()}))},t})(o.Component);A.defaultProps={onCancelSearch:function(){}},t.SearchBarComponent=A;var D=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleNavigation=function(){t._searchBarInput.blurSearchBarTextInput()},t._onMouseDown=function(e){e.stopPropagation(),e.preventDefault(),T.redirect(new I({path:"/team/upgrade",query:{tk:"search_upsell_bar",camp:"web"}}).toString())},t._renderUpsellBar=function(){return t.props.limitedTeamBannerUpsell?o.createElement("div",{className:"search-bar__upsell"},o.createElement("div",{className:"search-bar__upsell__message"},R._("Search through file contents in addition to file names with %(trademark_business)s").format({trademark_business:t.props.trademarkBusiness})),o.createElement("div",{className:"search-bar__upsell__action"},o.createElement(_.button,{className:"search-bar__upsell__cta-button",onMouseDown:t._onMouseDown},R._("Upgrade")))):void 0},t._onFileOrFolderOpen=function(e){t.props.onFileOrFolderOpen(e),t._handleNavigation()},t._onSearch=function(e,r){t.props.onSearch(e,r),t._handleNavigation()},t._setSearchBarInputRef=function(e){return t._searchBarInput=e},t}return r.__extends(t,e),t.prototype.getSearchBarInput=function(){return this._searchBarInput},t.prototype.render=function(){var e={"search-bar":!0,"is-expanded":this.props.isSearchActive,"is-focused":this.props.isFocused,"is-active":this.props.isActive};return o.createElement("div",{className:"search-bar--container u-l-fr"},o.createElement("div",{className:n(e)},o.createElement(O,{isActive:this.props.isActive,isFocused:this.props.isFocused,onFileOrFolderOpen:this.props.onFileOrFolderOpen,onInputChange:this.props.onInputChange,onInputKeydown:this.props.onInputKeydown,onInputSubmit:this.props.onInputSubmit,onSearchBarBlur:this.props.onSearchBarBlur,onSearchBarFocus:this.props.onSearchBarFocus,rawQuery:this.props.rawQuery,highlightedRow:this.props.highlightedRow,isAdminConsole:this.props.isAdminConsole,placeholder:this.props.placeholder,ref:this._setSearchBarInputRef}),this.props.normalizedQuery&&this.props.normalizedQuery.length&&o.createElement(y,{onFileOrFolderOpen:this._onFileOrFolderOpen,onSearch:this._onSearch,currentPath:this.props.currentPath,highlightedRow:this.props.highlightedRow,isOpen:this.props.isFocused,normalizedQuery:this.props.normalizedQuery,onHighlightDropdownItem:this.props.onHighlightDropdownItem,suggestions:this.props.suggestions,bottomBanner:this._renderUpsellBar(),searchBarLoading:this.props.searchBarLoading,isAdminConsole:this.props.isAdminConsole})))},t})(o.Component);D.defaultProps={rawQuery:"",normalizedQuery:"",isAdminConsole:!1};var O=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onKeydown=function(e){e.keyCode===u.KeyCode.ESC&&(t.blurSearchBarTextInput(),i(t._searchBarTextInput).val("")),t.props.onInputKeydown(e)},t._onSubmit=function(e){var r=f.searchStore.highlightedSearchRow();return t.props.isAdminConsole||t.blurSearchBarTextInput(),t.props.onInputSubmit(e,r)},t._setSearchBarTextInputRef=function(e){return t._searchBarTextInput=e},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){i(this._searchBarTextInput).on("keydown.SearchBarInput",this._onKeydown),i(this._searchBarTextInput).on("focusout.SearchBarInput",this.props.onSearchBarBlur)},t.prototype.componentWillUnmount=function(){i(this._searchBarTextInput).off(".SearchBarInput")},t.prototype.getSearchBarTextInput=function(){return this._searchBarTextInput},t.prototype.blurSearchBarTextInput=function(){this._searchBarTextInput.blur()},t.prototype.render=function(){return o.createElement("form",{className:"search-bar__input",onSubmit:this._onSubmit},o.createElement("input",{"aria-activedescendant":"search-dropdown-suggestion"+this.props.highlightedRow,"aria-autocomplete":"list","aria-expanded":this.props.isFocused&&this.props.isActive,"aria-label":R._("Search"),"aria-owns":"search-bar__suggestions",className:"search-bar__text-input",onChange:this.props.onInputChange,onFocus:this.props.onSearchBarFocus,placeholder:this.props.placeholder?this.props.placeholder:R._("Search"),ref:this._setSearchBarTextInputRef,role:"combobox",defaultValue:this.props.rawQuery,tabIndex:d.LAYOUT_TAB_ORDER.SEARCH_BAR}),o.createElement("button",{"aria-label":R._("Search"),className:"search-bar__button",type:"submit"},o.createElement(s.IconGlobal,{name:"search-small"})))},t})(o.Component),y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._announceLoading=function(){g.AccessibleAnnounce.polite(R._("Loading search…"))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.searchBarLoading&&this._announceLoading()},t.prototype.componentDidUpdate=function(e){this.props.searchBarLoading&&!e.searchBarLoading&&this._announceLoading(),this.props.normalizedQuery&&e.searchBarLoading&&!this.props.searchBarLoading&&g.AccessibleAnnounce.polite(R.ungettext("Found %(num)s search result","Found %(num)s search results",this.props.suggestions.length).format({num:this.props.suggestions.length}))},t.prototype.render=function(){!this.props.searchBarLoading&&this.props.isOpen&&this.props.bottomBanner&&!this._banner_view_logged&&(this._banner_view_logged=!0,a.TeamsWebActionsLogger.log("banner_search_displayed",{location:"search_bar",item_count:this.props.suggestions.length}));for(var e=[],t=0;t<this.props.suggestions.length;t++){var r=this.props.suggestions[t];r instanceof l.File?e.push(o.createElement(L,{resultObject:r,key:r.fq_path,onFileOrFolderOpen:this.props.onFileOrFolderOpen,onHighlightDropdownItem:this.props.onHighlightDropdownItem,rank:t,highlightedRow:this.props.highlightedRow})):r instanceof l.Paper&&e.push(o.createElement(N,{resultObject:r,key:r.pad_id,onFileOrFolderOpen:this.props.onFileOrFolderOpen,onHighlightDropdownItem:this.props.onHighlightDropdownItem,rank:t,highlightedRow:this.props.highlightedRow}))}var s={"search-bar__dropdown":!0,"is-expanded":this.props.isOpen};return o.createElement("div",{className:n(s),"aria-hidden":!this.props.isOpen},o.createElement("div",{className:"search-bar__suggestions",id:"search-bar__suggestions"},o.createElement(C,{onSearch:this.props.onSearch,onHighlightDropdownItem:this.props.onHighlightDropdownItem,currentPath:this.props.currentPath,normalizedQuery:this.props.normalizedQuery,highlightedRow:this.props.highlightedRow}),e),this.props.searchBarLoading?o.createElement("div",{className:"search-bar__loading"},o.createElement("span",{className:"ax-visually-hidden"},R._("Loading search..."))):this.props.bottomBanner)},t})(o.Component);y.defaultProps={isAdminConsole:!1};var C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderTitle=function(){return["/",""].includes(t.props.currentPath)?E.reactFormat(R._("View all results for <strong>%(query)s</strong>"),{query:t.props.normalizedQuery,strong:o.createElement("strong",null)}):E.reactFormat(R._("Search for ‘<strong>%(query)s</strong>’ in %(current_path)s"),{current_path:c.filename(t.props.currentPath),query:t.props.normalizedQuery,strong:o.createElement("strong",null)})},t._onMouseDown=function(){return t.props.onSearch(t.props.normalizedQuery,f.searchStore.searchSessionID())},t._onMouseEnter=function(){return t.props.onHighlightDropdownItem(0)},t}return r.__extends(t,e),t.prototype.render=function(){var e=0===this.props.highlightedRow,t={"search-bar__suggestion":!0,"search-bar__suggestion--is-highlighted":e,"search-bar__full_search_suggestion":!0};return o.createElement("div",{className:n(t),id:"search-dropdown-suggestion0",onMouseDown:this._onMouseDown,onMouseEnter:this._onMouseEnter,role:"option","aria-selected":e},o.createElement("div",{className:"search-bar__suggestion-icon--search"}),o.createElement("div",{className:"search-bar__suggestion-first-row-name"},this._renderTitle()))},t})(o.Component),N=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.resultObject;return o.createElement(v,r.__assign({},this.props,{icon:"paper_white_32",title:m.highlightMatchReact(e.title,e.title_highlights),location:"Paper"}))},t})(o.Component),L=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.resultObject,t=c.filename(e.fq_path),n=c.parent_dir(e.fq_path),s="Dropbox",i=n.split("/");i.shift(),e.is_unmounted&&i.length>0&&(s=i.shift());var a=i[i.length-1];return i.length>=2&&(s+="/..."),a&&a.length&&(s+="/"+a),o.createElement(v,r.__assign({},this.props,{icon:e.icon,title:m.highlightMatchReact(t,e.filename_highlights),location:s,isUnmounted:e.is_unmounted}))},t})(o.Component),v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onMouseDown=function(){return t.props.onFileOrFolderOpen(t.props.resultObject)},t._onMouseEnter=function(){return t.props.onHighlightDropdownItem(t._listIndex)},t}return r.__extends(t,e),t.prototype.render=function(){var e;this._listIndex=this.props.rank+1;var t=this._listIndex===this.props.highlightedRow,r={"search-bar__suggestion":!0,"search-bar__suggestion--is-highlighted":t};return e=this.props.isUnmounted?E.reactFormat(R._("not added yet, in <locationSpan>%(location)s</locationSpan>",{comment:"Describes the mountable directory of a file in a list of search results."}),{location:this.props.location,locationSpan:o.createElement("span",{title:this.props.location})}):E.reactFormat(R._("<locationSpan>in %(location)s</locationSpan>",{comment:"Describes the parent directory of a file in a list of search results."}),{location:this.props.location,locationSpan:o.createElement("span",{title:this.props.location})}),o.createElement("li",{className:n(r),id:"search-dropdown-suggestion"+this._listIndex,role:"option","aria-selected":t,onMouseDown:this._onMouseDown,onMouseEnter:this._onMouseEnter},o.createElement(p,{group:"web",name:this.props.icon,className:"search-bar__suggestion-icon",alt:""}),o.createElement("div",null,o.createElement("div",{className:"search-bar__suggestion-name"},this.props.title),o.createElement("div",{className:"search-bar__suggestion-desc"},e)))},t})(o.Component);t.SearchBar=h(A,["/static/css/search/search_bar_react-vfl9NVUaJ.css"])}),define("modules/clean/search/search_helpers",["require","exports","jquery","external/classnames","react","modules/clean/analytics","modules/clean/search/store","modules/clean/history"],function(e,t,r,n,s,o,i,a){"use strict";function c(e,t,r){void 0===t&&(t=""),void 0===r&&(r="");var n=l(t,r);return a.construct_url("/search/"+e.role,n)}function l(e,t){return void 0===e&&(e=""),void 0===t&&(t=""),{query:e.toLowerCase().trim().replace(/\ +/g," "),query_unnormalized:e,last_fq_path:t}}function u(e,t,r,n){void 0===n&&(n="full-view");var s={file_nsid:e.ns_id,file_sjid:e.sjid,firefly:!0,match_type:e.match_type,position:e.sort_rank,request_id:e.request_id,viewport:n,action_type:r,search_session_id:i.searchStore.searchSessionID()};o.SearchClientActivityLogger.log("result_action",t.id,s)}function _(e,t,r,n){void 0===n&&(n="full-view");var s={firefly:!1,paper_pad_id:e.pad_id,position:e.sort_rank,request_id:e.request_id,viewport:n,action_type:r,search_session_id:i.searchStore.searchSessionID()};o.SearchClientActivityLogger.log("result_action",t.id,s)}function h(e,t){if(!t||!t.length)return[];var r=[],n=0;return t.forEach(function(t){var s=t.pos;s>n&&(n=s);var o=e.indexOf(t.string,n);o>=0&&r.push({pos:o,len:t.string.length,string:t.string})}),r}function d(e,t){if(!t)return[{text:e,isHighlighted:!1}];t=h(e,t);for(var r=0,n=0,s=[];r<e.length;){var o=void 0,i=void 0,a=t[n];n>=t.length?(i=!1,o=r+e.length):a.pos>r?(i=!1,o=a.pos):(i=!0,o=a.pos+a.len);var c=e.substring(r,o);s.push({text:c,isHighlighted:i}),r=o,i&&n++}return s}function p(e,t){return d(e,t).reduce(function(e,t){var n=r("<span/>").text(t.text);return t.isHighlighted&&(n.addClass("highlighted"),n.addClass("is-highlighted")),e.append(n)},r("<span />"))}function E(e,t){var r=d(e,t);return s.createElement("span",null,r.map(function(e,t){return s.createElement("span",{className:n({highlighted:e.isHighlighted,"is-highlighted":e.isHighlighted}),key:t},e.text)}))}t.buildSearchURL=c,t.queryParams=l,t.logSearchAction=u,t.logPaperSearchAction=_,t.highlightMatchSections=d,t.highlightMatchJQuery=p,t.highlightMatchReact=E}),
define("modules/clean/search/search_type",["require","exports"],function(e,t){"use strict";t.SearchType={COMPLETION:"completion",DELETED:"deleted",FULLTEXT:"full-text"}}),define("modules/clean/search/store",["require","exports","tslib","external/immutable","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/react/selectable_list","modules/clean/search/constants","modules/clean/react/browse/constants","modules/clean/react/browse/models"],function(e,t,r,n,s,o,i,a,c,l){"use strict";var u=(function(e){function t(t){var r=e.call(this,t)||this;return r._resetSearchBar(),r._resetSearchResults(),r}return r.__extends(t,e),t.prototype._resetSearchBar=function(){this._isSearchBarFocused=!1,this._isSearchBarLoading=!1,this._rawQuery="",this._normalizedQuery="",this._searchSessionID="",this._searchSuggestions=[],this._highlightedSearchRow=0},t.prototype._resetSearchResults=function(){this._browseContext=new l.BrowseContext,this._latestQuery="",this._loadingState="LOADED",this._searchResults=n.List.of(),this._selection=i.createSelection(),this._hasMoreLiveResults=!0,this._numDeletedResults=0,this._hasMoreDeletedResults=!0,this._didLoadDeletedResults=!1},t.prototype.isSearchBarFocused=function(){return this._isSearchBarFocused},t.prototype.isSearchBarActive=function(){return!!this._rawQuery},t.prototype.isSearchBarLoading=function(){return this._isSearchBarLoading},t.prototype.rawQuery=function(){return this._rawQuery},t.prototype.normalizedQuery=function(){return this._normalize(this._rawQuery)},t.prototype.searchSuggestions=function(){return this._searchSuggestions},t.prototype.highlightedSearchRow=function(){return this._highlightedSearchRow},t.prototype.searchSessionID=function(){return this._searchSessionID},t.prototype.browseContext=function(){return this._browseContext},t.prototype.latestQuery=function(){return this._latestQuery},t.prototype.loadingState=function(){return this._loadingState},t.prototype.searchResults=function(){return this._searchResults},t.prototype.hasMoreResults=function(e){return void 0===e&&(e=!1),this._hasMoreLiveResults||e&&this._hasMoreDeletedResults},t.prototype.numDeletedResults=function(){return this._numDeletedResults},t.prototype.didLoadDeletedResults=function(){return this._didLoadDeletedResults},t.prototype.selection=function(){return this._selection},t.prototype.selectedFiles=function(){var e=this,t=this._searchResults.filter(function(t){return t instanceof l.File&&e._selection.selected.has(t.fq_path)});return n.OrderedMap(t.map(function(e){return[e.fq_path,e]}))},t.prototype._focusSearchBar=function(){this._isSearchBarFocused=!0,this._highlightedSearchRow=0,this.emit_change()},t.prototype._blurSearchBar=function(){this._isSearchBarFocused=!1,this._highlightedSearchRow=0,this.emit_change()},t.prototype._normalize=function(e){return e.trim().replace(/\ +/g," ")},t.prototype._isBlank=function(e){return!this._normalize(e)},t.prototype._shouldStartNewSearchSession=function(e,t){return!(!this._isBlank(e)||this._isBlank(t))||e.length>=3&&1===t.length},t.prototype._generateRandomID=function(){for(var e="",t=0;t<32;t++){var r=Math.floor(10*Math.random());e+=String(r)}return e},t.prototype._setRawQuery=function(e,t){t?this._searchSessionID=t:this._shouldStartNewSearchSession(this._rawQuery,e)&&(this._searchSessionID=this._generateRandomID()),this._rawQuery=e},t.prototype._setSearchQuery=function(e){var t=e.query;this._setRawQuery(t),this._searchSuggestions=[],this._highlightedSearchRow=0,this._isSearchBarLoading=!!this.normalizedQuery(),this.emit_change()},t.prototype._setSearchSuggestions=function(e){var t=e.searchResults;this._isSearchBarLoading=!1,this._searchSuggestions=t,this.emit_change()},t.prototype._setHighlightedSearchRow=function(e){var t=e.index;this._highlightedSearchRow=t,this.emit_change()},t.prototype._highlightPreviousSearchRow=function(){this._highlightedSearchRow=Math.max(0,this._highlightedSearchRow-1),this.emit_change()},t.prototype._highlightNextSearchRow=function(){this._highlightedSearchRow=Math.min(this._searchSuggestions.length,this._highlightedSearchRow+1),this.emit_change()},t.prototype._startSearch=function(e){var t=e.query,r=e.qsid;this._resetSearchResults(),this._setRawQuery(t,r),this._latestQuery=this.normalizedQuery(),this._loadingState="LOADING_FIRST_PAGE",this.emit_change()},t.prototype._setSearchResults=function(e){var t=e.searchResults,r=e.context;this._setSearchResultsInternal(t),this._loadingState="LOADED",this._browseContext=r,this._updateMoreResults(t),this.emit_change()},t.prototype._setSearchResultsInternal=function(e){this._searchResults=n.List(e)},t.prototype._continueSearch=function(e){e.didLoadDeletedResults&&(this._didLoadDeletedResults=!0),this._loadingState="LOADING_ADDITIONAL_PAGE",this.emit_change()},t.prototype._appendSearchResults=function(e){var t=e.deleted,r=e.searchResults,n=e.context;t&&(this._numDeletedResults+=r.length),this._searchResults=this._searchResults.concat(r),this._loadingState="LOADED",this._browseContext=n,this._updateMoreResults(r),this.emit_change()},t.prototype._clearSearch=function(){this._resetSearchBar(),this._resetSearchResults(),this.emit_change()},t.prototype._updateMoreResults=function(e){var t=e.length===a.MaxResults.MAX_SEARCH_RESULTS;this._hasMoreLiveResults?this._hasMoreLiveResults=t:this._hasMoreDeletedResults&&(this._hasMoreDeletedResults=t)},t.prototype._setSearchSelection=function(e){var t=e.selection;this._selection=t,this.emit_change()},t.prototype._applyFileDeltas=function(e){var t=e.fileDeltas;if(t){for(var r=function(e,t){var r=void 0;!e&&t?n._searchResults=n._searchResults.push(t):e&&!t?(r=n._searchResults.findIndex(function(t){return t instanceof l.File&&s.paths_are_equal(t.fq_path,e)}),n._searchResults=n._searchResults.delete(r)):e&&t&&(r=n._searchResults.findIndex(function(t){return t instanceof l.File&&s.paths_are_equal(t.fq_path,e)}),n._searchResults=r>-1?n._searchResults.set(r,t):n._searchResults.push(t))},n=this,o=0,i=t;o<i.length;o++){var a=i[o];r(a.before,a.after)}this.emit_change()}},t.prototype._updateContext=function(e){this._browseContext=e.context},t.prototype._new_payload=function(e){switch(e.action.type){case a.FOCUS_SEARCH_BAR_ACTION:this._focusSearchBar();break;case a.BLUR_SEARCH_BAR_ACTION:this._blurSearchBar();break;case a.SET_SEARCH_QUERY_ACTION:this._setSearchQuery(e.action.data);break;case a.SET_SEARCH_SUGGESTIONS_ACTION:this._setSearchSuggestions(e.action.data);break;case a.SET_HIGHLIGHTED_ROW_ACTION:this._setHighlightedSearchRow(e.action.data);break;case a.HIGHLIGHT_PREVIOUS_ROW_ACTION:this._highlightPreviousSearchRow();break;case a.HIGHLIGHT_NEXT_ROW_ACTION:this._highlightNextSearchRow();break;case a.START_SEARCH_ACTION:this._startSearch(e.action.data);break;case a.SET_SEARCH_RESULTS_ACTION:this._setSearchResults(e.action.data);break;case a.CONTINUE_SEARCH_ACTION:this._continueSearch(e.action.data);break;case a.APPEND_SEARCH_RESULTS_ACTION:this._appendSearchResults(e.action.data);break;case a.SET_SEARCH_SELECTION_ACTION:this._setSearchSelection(e.action.data);break;case a.CHANGE_FILES_ACTION:this._applyFileDeltas(e.action.data);break;case a.CLEAR_SEARCH_ACTION:this._clearSearch();break;case c.BrowseActionTypes.SET_URL_PREFIX:this._clearSearch();break;case c.BrowseActionTypes.LOAD_PATH:this._updateContext(e.action.data)}},t})(o);t.SearchStore=u,t.searchStore=new u}),define("modules/clean/search/types",["require","exports"],function(e,t){"use strict";t.SearchResultTypes={FILE:"FILE",PAPER:"PAPER"}}),function(){define("modules/clean/web_user_action_logger",["modules/clean/ajax"],function(e){var t,r,n,s;return s={DOWNLOAD:"download",MOVE:"move",OPEN_MOVE_MODAL:"open_move_modal",RENAME:"rename",ADD_COMMENT:"add_comment",OPEN_COPY_MODAL:"open_copy_modal",COPY:"copy",DELETE:"delete",PERMANENT_DELETE:"permanent_delete",VERSIONS:"versions",SORT_RECORDS:"sort_records",SELECT_ROW:"select_row",OPEN_ROW:"open_row",UPLOAD_FILE:"upload_file",CREATE_FOLDER:"create_folder",VIEW_SHARE_MODEL:"view_share_model",TOGGLE_DELETED_FILES:"toggle_deleted_files",NAV_NEW_PAGE:"nav_new_page",SWITCH_ACCOUNT:"switch_account",SWITCH_TO_GRID_VIEW:"switch_to_grid_view",SWITCH_TO_LIST_VIEW:"switch_to_list_view"},r=3,t=6e5,n=(function(){function n(){}return n.prototype.error_count=0,n.prototype.last_error=Date.now(),n.prototype.should_report=!0,n.prototype.log=function(n,s,o){if(this.should_report&&(this.error_count<r||Date.now()-this.last_error>t))return e.SilentBackgroundRequest({url:"/log/web_user_action",data:{_subject_uid:n,event_type:s,extra_params:JSON.stringify(o)},error:(function(e){return function(t){return 429===t.status?e.error_count=r:e.error_count+=1,e.last_error=Date.now()}})(this),success:(function(e){return function(t){var r,n;try{return r=JSON.parse(t),(null!=r?r.continue_sending:void 0)||(e.should_report=!1),e.error_count=0}catch(t){throw n=t,e.error_count+=1,e.last_error=Date.now(),n}}})(this)})},n})(),{WebUserActionLog:new n,WebUserActionLogEvents:s,WebUserActionLogClass:n,MAX_ERRORS:r}})}.call(this);
//# sourceMappingURL=pkg-maestro-embedded_app.min.js-vfllMLzqw.map