(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function o(){this.constructor=e}for(var i in t)n.call(t,i)&&(e[i]=t[i]);return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e},n={}.hasOwnProperty;define("modules/clean/legacy_pyxl_controllers/overquota_bubble_dropdown",["jquery","external/underscore","modules/clean/keycode","modules/clean/stormcrow/stormcrow_exposure_logger","modules/clean/legacy_pyxl_controllers/bubble_dropdown"],function(n,o,i,r,a){var s;return i.KeyCode,s=r.StormcrowExposureLogger,(function(n){function o(t){this._toggle_bubble=e(this._toggle_bubble,this),this.temp_var=t,o.__super__.constructor.apply(this,arguments),this.stormcrow_logger=new s}return t(o,n),o.prototype._toggle_bubble=function(){return this._dropdown_shown?this._hide_bubble():(this._show_bubble(),this.stormcrow_logger.logExposuresOnce({subgrowth_pro_header_dropdown_overquota:this.temp_var})),!0},o})(a)})}).call(this),function(){define("modules/clean/upsell/top_notification",["jquery","modules/core/notify","modules/clean/upsell/exception","modules/clean/upsell/upsell_controller","modules/clean/upsell/top_notification_common","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/top_notif","modules/clean/viewer"],function(e,t,n,o,i,r,a,s,l){var c;return c=r.EmailVerification,(function(){function r(e,t){var o;this.options=t;try{this._constructor(e)}catch(e){o=e,n.reportJsControllerException({err:o,js_controller_options:this.options})}}return r.prototype._constructor=function(n){var r,u;return this.options.isMaestro&&(e("#notify-wrapper").addClass("with-top-notification"),i.setTopNotificationClassOnBodyElement()),this.$top_notification_bar=e(n),this.$top_notification_bar.children().hasClass("over-quota-prompt-space")&&(this._resize_space_notification_bar(),e(window).on("resize",this._resize_space_notification_bar)),this.options.notDismissable?r=e():(r=this.$top_notification_bar.find("a:not(.dismiss-button)"),this.options.confirmInNewTab&&r.attr("target","_blank")),u=new o(r,this.$top_notification_bar.find(".dismiss-button"),this.options),u.log_impression(),o.register_custom_controller({on_confirm:this._on_acknowledge,on_dismiss:this._on_acknowledge}),this.$top_notification_bar.find("a").on("click",(function(t){return function(n){if(e(n.currentTarget).hasClass("top-notification-bar-dismiss")&&n.preventDefault(),!t.options.notDismissable)return s.TopNotificationBar.hide({clearPageletCache:!1})}})(this)),this.$top_notification_bar.find(".prompt-banner-email-verify-resend-link").on("click",(function(n){return function(o){var i,r,s;if(o.preventDefault(),u.log_event("send-email-link-clicked"),r=(function(){var e,t,n,o;for(n=l.get_viewer().get_users(),o=[],e=0,t=n.length;e<t;e++)s=n[e],s.is_email_verified||o.push(s);return o})()[0],null!=r)return i=c.get_for_user(r),i.send_email(a.PROMPT_CAMPAIGN,function(){return u.log_event("verification-email-sent"),t.success("Verification email sent!",5)}),i.ensure_polling(function(){return n.$top_notification_bar.hide(),e("body").removeClass("top-notification-bar"),u.log_event("email-verified"),t.success("Your email address was verified!")})}})(this)),this.$top_notification_bar.find(".over-quota-prompt-icon").on("mouseover",function(t){var n,o,i,r;return n=e("#over-quota-prompt-hover"),i=n.find(".over-quota-prompt-icon").position(),r=i.top+25,o=i.left-50,n.find("#tooltip-selector").css("padding","20px"),n.find(".tooltip-inner").css({width:"275px","text-align":"left"}),n.find(".tooltip-bubble").css({top:r,left:o,display:"block","font-size":"12px"}),n.find("#tooltip-selector").on("mouseleave",function(t){return e(".tooltip-bubble").css("display","none")})})},r.prototype._resize_space_notification_bar=function(){var t,n;return n=e(window).width(),t=.1*n,e("#top-notification-bar-container").css({"border-left":t+"px solid #F2768B"}),e("#prompt-top-notification-bar").css({"margin-left":t*-2+30+"px"})},r.prototype.unregister_custom_controller=function(){return o.unregister_custom_controller({on_confirm:this._on_acknowledge,on_dismiss:this._on_acknowledge})},r.prototype._on_acknowledge=function(e,t){if(!t.notDismissable&&window.ensemble&&window.ensemble.clearPageletCache)return window.ensemble.clearPageletCache()},r})()})}.call(this),define("modules/clean/user_education/react/user_education_banner",["require","exports","tslib","external/underscore","external/react","external/classnames","modules/clean/user_education/user_education_interface","modules/clean/user_education/user_education_client","modules/clean/user_education/react/user_education_spotlight","modules/clean/user_education/react/user_education_pulsar","modules/clean/react/image","modules/clean/react/modal","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,o,i,r,a,s,l,c,u,d,p,f){"use strict";var h=i.addons.CSSTransitionGroup,m=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={banner:{hide:t.hideOnload}},n.handleUpdate=n.handleUpdate.bind(n),n.handleRequestedEffectState=n.handleRequestedEffectState.bind(n),n.handleNextClick=n.handleNextClick.bind(n),n.handleSkipClick=n.handleSkipClick.bind(n),n.handleOverlayClick=n.handleOverlayClick.bind(n),n.handleExitOnboarding=n.handleExitOnboarding.bind(n),n}return n.__extends(t,e),t.prototype.componentWillMount=function(){s.eventEmitter.on(a.UserEducationStateChannel,this.handleUpdate,this),s.eventEmitter.on(a.UserEducationEffectChannel,this.handleRequestedEffectState,this)},t.prototype.componentWillUnmount=function(){s.eventEmitter.removeListener(a.UserEducationStateChannel,this.handleUpdate,this),s.eventEmitter.removeListener(a.UserEducationEffectChannel,this.handleRequestedEffectState,this)},t.prototype.handleRequestedEffectState=function(e){this._canRequestEffect(e)&&!this._isEffectEqual(this.state.requestedEffect,e)&&this.setState({requestedEffect:e,banner:this.state.banner})},t.prototype._isEffectEqual=function(e,t){return o.isEqual(e,t)&&this._isRectEqual(e.rect,t.rect)},t.prototype._isRectEqual=function(e,t){return e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right&&e.width===t.width&&e.height===t.height},t.prototype._canRequestEffect=function(e){return this.state.effect&&e.requester===this.state.effect.containerName+"."+this.state.effect.elementName},t.prototype.handleUpdate=function(e){if(e.state===a.UEEventType.ShowStep){var t=e.step;if(t.banner)return void this.setState({banner:t.banner,effect:t.effect,stepName:t.name})}this.setState({banner:{hide:!0,showNext:!1,canSkip:!1,isLastStep:this.state.banner.isLastStep,title:"",subtitle:""},effect:void 0})},t.prototype.handleNextClick=function(){s.UEClient.sendEvent(t.displayName,"nextClicked",{})},t.prototype.handleSkipClick=function(){this.showEndTourModal()},t.prototype.handleOverlayClick=function(){this.showEndTourModal()},t.prototype.handleExitOnboarding=function(){s.UEClient.sendEvent(t.displayName,"exitOnboarding",{})},t.prototype.showEndTourModal=function(){var e;this.props.experiments&&(e=this.props.experiments.subgrowthBizTeamExitModal),"V1"===e?d.Modal.showInstance(i.createElement(d.Modal,{title:f._("End the tour?"),acceptButtonText:f._("Continue"),dismissButtonText:f._("End"),onDismiss:this.handleExitOnboarding,className:"subgrowth_biz_team_exit_modal--V1"},i.createElement("div",{className:"db-modal-content-text"},f._("Click ‘Continue’ to keep learning about your new Dropbox.")))):"V2"===e?d.Modal.showInstance(i.createElement(d.Modal,{title:f._("Keep learning about your new Dropbox"),acceptButtonText:f._("Keep learning"),onDismiss:this.handleExitOnboarding,className:"subgrowth_biz_team_exit_modal--V2"},i.createElement("div",{className:"db-modal-content-text"},f._("Closing this dialog window will end the tour here, or click on ‘Keep learning’ to continue.")))):d.SimpleModal.show({title_text:f._("End the tour?"),body_html:f._("To keep learning about your new Dropbox account, click ‘cancel’."),cancel_text:f._("Cancel"),confirm_text:f._("End tour"),confirm_callback:this.handleExitOnboarding})},t.prototype.shouldHaveWrappedOverlay=function(){return this.state.requestedEffect&&this._canRequestEffect(this.state.requestedEffect)&&this.state.effect&&this.state.effect.effect===a.UEEffectType.Pulsar},t.prototype.renderOverlay=function(){if(this.state.banner.hide)return null;if(this.shouldHaveWrappedOverlay()){var e=this.state.requestedEffect.rect,t={top:0,left:0,width:e.left,bottom:0},n={top:0,left:e.left,width:e.width,height:e.top},o={top:0,right:0,left:e.left+e.width,bottom:0},r={top:e.top+e.height,left:e.left,width:e.width,bottom:0};return i.createElement("div",{className:"ue-overlay-container"},i.createElement("div",{className:"ue-partial-overlay",style:t,onClick:this.handleOverlayClick}),i.createElement("div",{className:"ue-partial-overlay",style:n,onClick:this.handleOverlayClick}),i.createElement("div",{className:"ue-partial-overlay",style:o,onClick:this.handleOverlayClick}),i.createElement("div",{className:"ue-partial-overlay",style:r,onClick:this.handleOverlayClick}))}return i.createElement("div",{className:"ue-full-overlay",onClick:this.handleOverlayClick})},t.prototype.renderButton=function(){if(this.state.banner.showNext){var e=this.state.banner.isLastStep?f._("Done"):f._("Next");return i.createElement("button",{className:"ue-next-button button-secondary",onClick:this.handleNextClick},e)}return null},t.prototype.renderSkip=function(){return this.state.banner.canSkip?i.createElement("p",null,i.createElement("button",{className:"ue-skip-link",onClick:this.handleSkipClick},f._("Skip"))):null},t.prototype.renderLoadingImg=function(){return this.state.banner.showLoading?i.createElement(u,{className:"ue-banner-loading-img",src:p.static_url("/static/images/dotload-vfl8mEFXg.gif"),srcHiRes:p.static_url("/static/images/dotload@2x-vfl66Z9jW.gif"),alt:f._("Animated loading icon.")}):null},t.prototype.renderEffect=function(){var e=null,t=null;if(this.state.effect&&this.state.requestedEffect&&this._canRequestEffect(this.state.requestedEffect)){var o=this.state.requestedEffect.rect;this.state.effect.effect===a.UEEffectType.Spotlight?e=i.createElement(l.UserEducationSpotlight,n.__assign({},this.state.effect.effectDetail,{rect:o,key:this.state.effect.containerName+"."+this.state.effect.elementName,experiments:this.props.experiments})):this.state.effect.effect===a.UEEffectType.Pulsar&&(t=i.createElement(c.UserEducationPulsar,n.__assign({},this.state.effect.effectDetail,{rect:o})))}return i.createElement("div",null,i.createElement(h,{transitionName:"ue-spotlight",transitionAppear:!1,transitionEnter:this.props.useReactCSSTransitionGroup,transitionLeave:this.props.useReactCSSTransitionGroup,transitionEnterTimeout:400,transitionLeaveTimeout:300},e),t)},t.prototype.render=function(){var e=r({"ue-banner-container":!0,hide:this.state.banner.hide,showNext:this.state.banner.showNext||!1,"confirmation-banner":this.state.banner.isLastStep||!1},"ue-step-"+this.state.stepName);return i.createElement("div",null,this.renderEffect(),this.renderOverlay(),i.createElement("div",{className:e},i.createElement(h,{transitionName:"ue-banner-center-contents",transitionAppear:!1,transitionEnter:this.props.useReactCSSTransitionGroup,transitionLeave:this.props.useReactCSSTransitionGroup,transitionEnterTimeout:700,transitionLeaveTimeout:400},i.createElement("div",{className:"ue-banner-center-contents",key:this.state.banner.title},i.createElement("h1",{className:"ue-banner-title"},this.state.banner.title),i.createElement("p",{className:"ue-banner-subtitle"},this.state.banner.subtitle),this.renderLoadingImg(),this.renderButton())),this.renderSkip()))},t})(i.Component);m.displayName="UserEducationBanner",m.defaultProps={hideOnload:!0,useReactCSSTransitionGroup:!0},t.UserEducationBanner=m}),define("modules/clean/user_education/react/user_education_pulsar",["require","exports","tslib","external/react","modules/clean/user_education/user_education_interface"],function(e,t,n,o,i){"use strict";var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getOffsetX=function(){var e=i.UserEducationPulsarSize/2,t=0;switch(this.props.position){case i.UserEducationEffectPosition.Center:t=this.props.rect.width/2+e;break;case i.UserEducationEffectPosition.LeftCenter:t=0+e,1;break;case i.UserEducationEffectPosition.RightCenter:t=this.props.rect.width-e,-1;break;default:throw new Error("UserEducationSpotlight: unknown postion value "+this.props.position)}return this.props.rect.left+t+this.props.offsetX},t.prototype.getOffsetY=function(){return this.props.rect.top+this.props.rect.height/2+this.props.offsetY},t.prototype.render=function(){var e={top:this.getOffsetY(),left:this.getOffsetX()};return o.createElement("div",{className:"ue-pulse",style:e},o.createElement("svg",{className:"ue-pulse-svg"},o.createElement("circle",{cx:"50%",cy:"50%",r:"50%"})))},t})(o.Component);r.displayName="UserEducationPulsar",r.defaultProps={position:i.UserEducationEffectPosition.LeftCenter,offsetX:0,offsetY:0},t.UserEducationPulsar=r}),define("modules/clean/user_education/react/user_education_spotlight",["require","exports","tslib","external/react","external/classnames","modules/clean/user_education/user_education_interface","modules/clean/react/image","modules/clean/static_urls"],function(e,t,n,o,i,r,a,s){"use strict";var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getSizeClass=function(){switch(this.props.size){case r.UserEducationSpotlightSize.Small:return"small";case r.UserEducationSpotlightSize.Medium:return"medium";case r.UserEducationSpotlightSize.Large:return"large";case r.UserEducationSpotlightSize.XLarge:return"x-large"}throw new Error("Unknown UserEducationSpotlightSize")},t.prototype.getOffsetX=function(){var e=0,t=0;switch(this.props.position){case r.UserEducationEffectPosition.Center:e=this.props.rect.width/2;break;case r.UserEducationEffectPosition.LeftCenter:e=0,t=1;break;case r.UserEducationEffectPosition.RightCenter:e=this.props.rect.width,t=-1;break;default:throw new Error("UserEducationSpotlight: unknown postion value "+this.props.position)}switch(this.props.size){case r.UserEducationSpotlightSize.Small:e+=40*t;break;case r.UserEducationSpotlightSize.Medium:e+=50*t;break;case r.UserEducationSpotlightSize.Large:e+=75*t;break;case r.UserEducationSpotlightSize.XLarge:e+=100*t;break;default:throw new Error("UserEducationSpotlight: unknown size value "+this.props.size)}return this.props.rect.left+e+this.props.offsetX},t.prototype.getOffsetY=function(){return this.props.rect.top+this.props.rect.height/2+this.props.offsetY},t.prototype.getSubgrowthBizTeamOnboardingMagnifierClass=function(){return this.props.experiments&&this.props.experiments.subgrowthBizTeamOnboardingMagnifier?"subgrowth_biz_team_onboarding_magnifier--V1":""},t.prototype.render=function(){var e={top:this.getOffsetY(),left:this.getOffsetX()};return o.createElement("div",{className:"ue-spotlight",style:e},o.createElement(a,{className:i("ue-spotlight-circle",this.getSizeClass(),this.getSubgrowthBizTeamOnboardingMagnifierClass()),src:s.static_url("/static/images/spotlight-vfllMyJQf.svg")}))},t})(o.Component);l.displayName="UserEducationSpotlight",l.defaultProps={size:r.UserEducationSpotlightSize.Medium,position:r.UserEducationEffectPosition.LeftCenter,offsetX:0,offsetY:0},t.UserEducationSpotlight=l}),define("modules/clean/user_education/user_education_controller",["require","exports","tslib","external/underscore","external/redux","modules/clean/user_education/user_education_interface","modules/clean/user_education/user_education_client","modules/clean/ajax"],function(e,t,n,o,i,r,a,s){"use strict";function l(){a.eventEmitter.on(r.UserEducationStateChannel,function(e){(console.warn||console.log)("MASTER-"+r.UserEducationStateChannel,e)}),a.eventEmitter.on(r.UserEducationEventChannel,function(e){console.log("MASTER-"+r.UserEducationEventChannel,e)})}function c(){return i.createStore(d)}function u(e,t,n,o){if(window.ensemble){var i=window.ensemble.viewer.getActiveUser().userId,r={module_name:e,event_name:t,status:n,extra:JSON.stringify(o)};r._subject_uid=String(i),s.SilentBackgroundRequest({url:"/log/onboarding",data:r})}}function d(e,i){if(!e)return _;if(h(i,t.AddModuleAction)){var r=i.payload.module;return n.__assign({},e,{modules:n.__assign({},e.modules,(d={},d[r.name]=r,d))})}if(h(i,t.ActivateAndAdvanceAction)){var a=i.payload,s=a.name,l=a.step;if(!e.modules[s])throw new Error("module("+s+") does not exists");if(l>=e.modules[s].steps.length)throw new Error("module("+s+") step("+l+") is out of bound");return n.__assign({},e,{activeModule:s,curStep:l})}if(h(i,t.ExitModuleEventAction))return n.__assign({},e,{activeModule:"",curStep:-1});if(h(i,t.UserEducationEventAction)){if(e.activeModule){var c=e.modules[e.activeModule].steps[e.curStep].condition;if(p(c,i.payload.event))return e.modules[e.activeModule].steps.length===e.curStep+1?n.__assign({},e,{activeModule:"",curStep:-1,finishedModules:e.finishedModules.concat([e.activeModule])}):n.__assign({},e,{curStep:e.curStep+1})}else for(var s in e.modules)if(o.indexOf(e.finishedModules,s)===-1){var u=e.modules[s],c=u.steps[0].condition;if(p(c,i.payload.event))return n.__assign({},e,{activeModule:s,curStep:1})}return e}return e;var d}function p(e,t){var n=e.eventName,i=e.eventData;return n===t.containerName+"."+t.name&&o.isMatch(t.data||{},i)}var f=function(e){return o.extend(function(t){return{type:e,payload:t}},{type:e})},h=function(e,t){return e.type===t.type};t.AddModuleAction=f("ADD_MODULE"),t.ActivateAndAdvanceAction=f("ACTIVATE_AND_ADVANCE"),t.ExitModuleEventAction=f("EXIT_MODULE"),t.UserEducationEventAction=f("UE_EVENT"),t.initializeReduxStore=c;var m=(function(){function n(e,n){n&&l(),this.store=c();for(var o=0,i=e;o<i.length;o++){var s=i[o];this.store.dispatch(t.AddModuleAction({module:s}))}this.handleEvent=this.handleEvent.bind(this),a.eventEmitter.on(r.UserEducationEventChannel,this.handleEvent,this),this.sendCurState()}return n.prototype.unsubscribe=function(){a.eventEmitter.removeListener(r.UserEducationEventChannel,this.handleEvent,this)},n.prototype._sendState=function(e){a.eventEmitter.emit(r.UserEducationStateChannel,e)},n.prototype.sendCurState=function(){this._sendState(this._getCurState())},n.prototype.handleEvent=function(e){if(e.name===r.UEEventType.Subscribe)this.sendCurState();else{var n=this.store.getState();if(this.isExitModuleEvent(e)){if(this.store.dispatch(t.ExitModuleEventAction({})),this.markHomeOnboardingComplete(n.activeModule,!0),n.activeModule){var i=this._getCurrentStepName(n);u(n.activeModule,i,"skip",null)}}else this.store.dispatch(t.UserEducationEventAction({event:e}));var a=this.store.getState();if(!o.isEqual(n,a))if(this.sendCurState(),a.activeModule){var i=this._getCurrentStepName(a);i&&u(a.activeModule,i,"shown",null)}else o.isEqual(n.finishedModules,a.finishedModules)||(this.markHomeOnboardingComplete(n.activeModule,!1),u(a.finishedModules[a.finishedModules.length-1],"finished",null,null))}},n.prototype.markHomeOnboardingComplete=function(t,n){var i="home_v0"===t&&n;o(["home_v0","home_v1"]).contains(t)&&e(["modules/clean/react/home/home_access/onboarding/actions"],function(e){return e.markHomeOnboardingComplete(i)})},n.prototype.isExitModuleEvent=function(e){return"UserEducationBanner"===e.containerName&&"exitOnboarding"===e.name},n.prototype._getCurState=function(){var e=this.store.getState();return e.activeModule||0!==e.finishedModules.length?e.activeModule?{state:r.UEEventType.ShowStep,step:e.modules[e.activeModule].steps[e.curStep]}:{state:r.UEEventType.Finished}:{state:r.UEEventType.Ready}},n.prototype._getCurrentStepName=function(e){if(e.activeModule){return e.modules[e.activeModule].steps[e.curStep].name||""}return""},n})();t.UserEducationController=m;var _={activeModule:"",curStep:-1,modules:{},finishedModules:[]}}),define("modules/clean/user_education/user_education_pagelet",["require","exports","external/react","external/react-dom","modules/clean/react/modal","modules/clean/user_education/user_education_loader","modules/clean/user_education/user_education_client","modules/clean/user_education/user_education_controller","modules/clean/user_education/react/user_education_banner"],function(e,t,n,o,i,r,a,s,l){"use strict";function c(t){function i(e,n){if(null!==e&&null!==n){for(var o=[],i=0,r=n;i<r.length;i++){var l=r[i];e[l]?o.push(e[l]):console.error("UserEducationModule was not found",l)}a&&console.log("Initializing User Education modules:",n),d=new s.UserEducationController(o,a),t.asyncLoadOverride&&u(t.asyncLoadOverride)}}var a=localStorage&&"ON"===localStorage.getItem("db-user-eudcation-debug");if(t.addBanner){var c=document.getElementById("user-education");c&&o.render(n.createElement(l.UserEducationBanner,{hideOnload:!0,experiments:t.experiments}),c)}"OFF"===t.asyncLoadOverride&&(t.asyncLoadOverride=null);var p=null,f=null;e(["modules/clean/user_education/modules/all"],function(e){p=e.UEModules,i(p,f)}),t.asyncLoadOverride&&r.UELoader.notifyModuleToLoad(t.asyncLoadOverride),r.UELoader.setLoadingCallback(function(e){f=[],null!==e&&f.push(e),i(p,f)})}function u(e){var t=n.createElement("div",null,n.createElement("img",{className:"welcome-maestro-modal__dropbox-illo u-mar-top-s",alt:"Dropbox logo",src:"/static/images/teams/onboarding/welcome_dropbox_illo-vflPEZsCl.png"}),n.createElement("h1",{className:"welcome-maestro-modal__header"},e),n.createElement("div",{className:"welcome-maestro-modal__subheader"},"This is modal is for testing onboarding module.")),o=n.createElement(i.Modal,{acceptButtonText:"Next",clickOutToClose:!1,width:540,style:"clean",className:"welcome-maestro-modal",showX:!1,onAccept:function(){a.UEClient.sendEvent("OnboardingPromptModal","ConfirmButtonClicked",{name:e})}},t);i.Modal.showInstance(o),a.UEClient.sendEvent("OnboardingPromptModal","Shown",{name:e})}var d;t.initialize_module=c});
//# sourceMappingURL=pkg-maestro-bz.min.js-vflntcqGT.map