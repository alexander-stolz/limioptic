(function(e,n){function t(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function r(e){return void 0===e}if(e){var c={},i=e.TraceKit,l=[].slice;c.noConflict=function(){return e.TraceKit=i,c},c.wrap=function(e){function n(){try{return e.apply(this,arguments)}catch(e){throw c.report(e),e}}return n},c.report=(function(){function n(e){a(),g.push(e)}function r(e){for(var n=g.length-1;n>=0;--n)g[n]===e&&g.splice(n,1)}function i(e,n){var r=null;if(!n||c.collectWindowErrors){for(var i in g)if(t(g,i))try{g[i].apply(null,[e].concat(l.call(arguments,2)))}catch(e){r=e}if(r)throw r}}function o(e,n,t,r,l){var o=null;if(d)c.computeStackTrace.augmentStackTraceWithInitialElement(d,n,t,e),u();else if(l)o=c.computeStackTrace(l),i(o,!0);else{var a={url:n,line:t,column:r};a.func=c.computeStackTrace.guessFunctionName(a.url,a.line),a.context=c.computeStackTrace.gatherContext(a.url,a.line),o={mode:"onerror",message:e,stack:[a]},i(o,!0)}return!!f&&f.apply(this,arguments)}function a(){p!==!0&&(f=e.onerror,e.onerror=o,p=!0)}function u(){var e=d,n=m;m=null,d=null,x=null,i.apply(null,[e,!1].concat(n))}function s(n){if(d){if(x===n)return;u()}var t=c.computeStackTrace(n);throw d=t,x=n,m=l.call(arguments,1),e.setTimeout(function(){x===n&&u()},t.incomplete?2e3:0),n}var f,p,g=[],m=null,x=null,d=null;return s.subscribe=n,s.unsubscribe=r,s})(),c.computeStackTrace=(function(){function n(n){if(!c.remoteFetching)return"";try{var t=function(){try{return new e.XMLHttpRequest}catch(n){return new e.ActiveXObject("Microsoft.XMLHTTP")}},r=t();return r.open("GET",n,!1),r.send(""),r.responseText}catch(e){return""}}function i(r){if("string"!=typeof r)return[];if(!t(k,r)){var c="",i="";try{i=e.document.domain}catch(e){}var l=/(.*)\:\/\/([^:\/]+)([:\d]*)\/{0,1}([\s\S]*)/.exec(r);l&&l[2]===i&&(c=n(r)),k[r]=c?c.split("\n"):[]}return k[r]}function l(e,n){var t,c=/function ([^(]*)\(([^)]*)\)/,l=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,o="",a=i(e);if(!a.length)return"?";for(var u=0;u<10;++u)if(o=a[n-u]+o,!r(o)){if(t=l.exec(o))return t[1];if(t=c.exec(o))return t[1]}return"?"}function o(e,n){var t=i(e);if(!t.length)return null;var l=[],o=Math.floor(c.linesOfContext/2),a=o+c.linesOfContext%2,u=Math.max(0,n-o-1),s=Math.min(t.length,n+a-1);n-=1;for(var f=u;f<s;++f)r(t[f])||l.push(t[f]);return l.length>0?l:null}function a(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function u(e){return a(e).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function s(e,n){for(var t,r,c=0,l=n.length;c<l;++c)if((t=i(n[c])).length&&(t=t.join("\n"),r=e.exec(t)))return{url:n[c],line:t.substring(0,r.index).split("\n").length,column:r.index-t.lastIndexOf("\n",r.index)-1};return null}function f(e,n,t){var r,c=i(n),l=new RegExp("\\b"+a(e)+"\\b");return t-=1,c&&c.length>t&&(r=l.exec(c[t]))?r.index:null}function p(n){if(!r(e&&e.document)){for(var t,c,i,l,o=[e.location.href],f=e.document.getElementsByTagName("script"),p=""+n,g=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,m=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,x=0;x<f.length;++x){var d=f[x];d.src&&o.push(d.src)}if(i=g.exec(p)){var h=i[1]?"\\s+"+i[1]:"",v=i[2].split(",").join("\\s*,\\s*");t=a(i[3]).replace(/;$/,";?"),c=new RegExp("function"+h+"\\s*\\(\\s*"+v+"\\s*\\)\\s*{\\s*"+t+"\\s*}")}else c=new RegExp(a(p).replace(/\s+/g,"\\s+"));if(l=s(c,o))return l;if(i=m.exec(p)){var _=i[1];if(t=u(i[2]),c=new RegExp("on"+_+"=[\\'\"]\\s*"+t+"\\s*[\\'\"]","i"),l=s(c,o[0]))return l;if(c=new RegExp(t),l=s(c,o))return l}return null}}function g(e){if(!e.stack)return null;for(var n,t,c=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,i=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|\[native).*?)(?::(\d+))?(?::(\d+))?\s*$/i,a=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:ms-appx|https?|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,u=e.stack.split("\n"),s=[],p=/^(.*) is undefined$/.exec(e.message),g=0,m=u.length;g<m;++g){if(n=c.exec(u[g])){var x=n[2]&&n[2].indexOf("native")!==-1;t={url:x?null:n[2],func:n[1]||"?",args:x?[n[2]]:[],line:n[3]?+n[3]:null,column:n[4]?+n[4]:null}}else if(n=a.exec(u[g]))t={url:n[2],func:n[1]||"?",args:[],line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=i.exec(u[g])))continue;t={url:n[3],func:n[1]||"?",args:n[2]?n[2].split(","):[],line:n[4]?+n[4]:null,column:n[5]?+n[5]:null}}!t.func&&t.line&&(t.func=l(t.url,t.line)),t.line&&(t.context=o(t.url,t.line)),s.push(t)}return s.length?(s[0]&&s[0].line&&!s[0].column&&p?s[0].column=f(p[1],s[0].url,s[0].line):s[0].column||r(e.columnNumber)||(s[0].column=e.columnNumber+1),{mode:"stack",name:e.name,message:e.message,stack:s}):null}function m(e){var n=e.stacktrace;if(n){for(var t,r=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,c=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,i=n.split("\n"),a=[],u=0;u<i.length;u+=2){var s=null;if((t=r.exec(i[u]))?s={url:t[2],line:+t[1],column:null,func:t[3],args:[]}:(t=c.exec(i[u]))&&(s={url:t[6],line:+t[1],column:+t[2],func:t[3]||t[4],args:t[5]?t[5].split(","):[]}),s){if(!s.func&&s.line&&(s.func=l(s.url,s.line)),s.line)try{s.context=o(s.url,s.line)}catch(e){}s.context||(s.context=[i[u+1]]),a.push(s)}}return a.length?{mode:"stacktrace",name:e.name,message:e.message,stack:a}:null}}function x(n){var r=n.message.split("\n");if(r.length<4)return null;var c,a=/^\s*Line (\d+) of linked script ((?:file|https?|blob)\S+)(?:: in function (\S+))?\s*$/i,f=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|https?|blob)\S+)(?:: in function (\S+))?\s*$/i,p=/^\s*Line (\d+) of function script\s*$/i,g=[],m=e&&e.document&&e.document.getElementsByTagName("script"),x=[];for(var d in m)t(m,d)&&!m[d].src&&x.push(m[d]);for(var h=2;h<r.length;h+=2){var v=null;if(c=a.exec(r[h]))v={url:c[2],func:c[3],args:[],line:+c[1],column:null};else if(c=f.exec(r[h])){v={url:c[3],func:c[4],args:[],line:+c[1],column:null};var _=+c[1],k=x[c[2]-1];if(k){var b=i(v.url);if(b){b=b.join("\n");var w=b.indexOf(k.innerText);w>=0&&(v.line=_+b.substring(0,w).split("\n").length)}}}else if(c=p.exec(r[h])){var E=e.location.href.replace(/#.*$/,""),y=new RegExp(u(r[h+1])),S=s(y,[E]);v={url:E,func:"",args:[],line:S?S.line:c[1],column:null}}if(v){v.func||(v.func=l(v.url,v.line));var T=o(v.url,v.line),O=T?T[Math.floor(T.length/2)]:null;T&&O.replace(/^\s*/,"")===r[h+1].replace(/^\s*/,"")?v.context=T:v.context=[r[h+1]],g.push(v)}}return g.length?{mode:"multiline",name:n.name,message:r[0],stack:g}:null}function d(e,n,t,r){var c={url:n,line:t};if(c.url&&c.line){e.incomplete=!1,c.func||(c.func=l(c.url,c.line)),c.context||(c.context=o(c.url,c.line));var i=/ '([^']+)' /.exec(r);if(i&&(c.column=f(i[1],c.url,c.line)),e.stack.length>0&&e.stack[0].url===c.url){if(e.stack[0].line===c.line)return!1;if(!e.stack[0].line&&e.stack[0].func===c.func)return e.stack[0].line=c.line,e.stack[0].context=c.context,!1}return e.stack.unshift(c),e.partial=!0,!0}return e.incomplete=!0,!1}function h(e,n){for(var t,r,i,o=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,a=[],u={},s=!1,g=h.caller;g&&!s;g=g.caller)if(g!==v&&g!==c.report){if(r={url:null,func:"?",args:[],line:null,column:null},g.name?r.func=g.name:(t=o.exec(g.toString()))&&(r.func=t[1]),void 0===r.func)try{r.func=t.input.substring(0,t.input.indexOf("{"))}catch(e){}if(i=p(g)){r.url=i.url,r.line=i.line,"?"===r.func&&(r.func=l(r.url,r.line));var m=/ '([^']+)' /.exec(e.message||e.description);m&&(r.column=f(m[1],i.url,i.line))}u[""+g]?s=!0:u[""+g]=!0,a.push(r)}n&&a.splice(0,n);var x={mode:"callers",name:e.name,message:e.message,stack:a};return d(x,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),x}function v(e,n){var t=null;n=null==n?0:+n;try{if(t=m(e))return t}catch(e){}try{if(t=g(e))return t}catch(e){}try{if(t=x(e))return t}catch(e){}try{if(t=h(e,n+1))return t}catch(e){}return{mode:"failed"}}function _(e){e=(null==e?0:+e)+1;try{throw new Error}catch(n){return v(n,e+1)}}var k={};return v.augmentStackTraceWithInitialElement=d,v.guessFunctionName=l,v.gatherContext=o,v.ofCaller=_,v.getSource=i,v})(),c.extendToAsynchronousCallbacks=function(){var n=function(n){var t=e[n];e[n]=function(){var e=l.call(arguments),n=e[0];return"function"==typeof n&&(e[0]=c.wrap(n)),t.apply?t.apply(this,e):t(e[0],e[1])}};n("setTimeout"),n("setInterval")},c.remoteFetching||(c.remoteFetching=!0),c.collectWindowErrors||(c.collectWindowErrors=!0),(!c.linesOfContext||c.linesOfContext<1)&&(c.linesOfContext=11),"undefined"!=typeof module&&module.exports&&this.module!==module?module.exports=c:"function"==typeof define&&define.amd?define("TraceKit",[],c):e.TraceKit=c}})("undefined"!=typeof window?window:global),define("modules/core/exception",["require","exports","tslib","external/tracekit","modules/constants/page_load","modules/core/exception_tag_registry","modules/pagelet_config","modules/core/xhr"],function(e,n,t,r,c,i,l,o){"use strict";function a(e){f.push(e)}function reportException(e){var t=e.err,c=e.force,i=e.tags,l=e.severity,o=e.exc_extra;if(!t.reported){var a=r.computeStackTrace(t),u=null!=(a&&a.stack)?a.stack:[];n._reportException({msg:t.message,stack:u,force:c,tags:i,severity:l,exc_extra:o}),t.reported=!0}}function _reportException(e){var n=e.msg,a=e.stack,f=e.force,g=e.tags,m=e.severity,x=e.exc_extra;if(!p||f){var d=["\\b_reportException\\b","\\breportException\\b","\\bassert\\b","\\breportStack\\b"],h=a,v=a,_=[];a=u(a,d);try{throw new Error}catch(e){var k=r.computeStackTrace(e);null!=k&&null!=k.stack&&(_=k.stack),v=_,_=u(_,d)}var b=a.length-_.length;b<=0&&(b=1);var w=a.slice(0,b),E=a.slice(b);if(g||(g=[]),g=g.concat(i.get_registered_tags()),x=x?t.__assign({},x):{},x.client_time=(new Date).toString(),x.client_utc_time=(new Date).toUTCString(),s+=1,x.exception_number=s,x.page_repo_rev=c.REPO_REV,x.page_load_timestamp=c.PAGE_LOAD_TIME,x.metaserver_mdb_tags=c.METASERVER_MDB_TAGS,x.user_locale=c.USER_LOCALE,null!=window.ensemble&&null!=window.ensemble.getPageletInfoForExceptionReporting){var y=window.ensemble.getPageletInfoForExceptionReporting();x.pagelet_info=y,x.current_pagelet=l.REQUIREJS_CONFIG.context,x.page_load_timestamp=Math.floor(Math.max.apply(Math,y.map(function(e){return e.pagelet_client_load_time}))),g=g.concat(["maestro-website"])}x.jsexclog_debug_stack_length=a.length,x.jsexclog_debug_context_length=_.length,x.jsexclog_debug_tracekit_stack1=h.reverse(),x.jsexclog_debug_tracekit_stack2=v.reverse();var S={e:n,loc:window.location.href,ref:document.referrer,stack:JSON.stringify(w.reverse()),context_tb:JSON.stringify(E.reverse()),tags:JSON.stringify(g),sev:m||"",exc_extra:JSON.stringify(x||{})};o.sendXhr("/jse",S),p=n}}function u(e,n){for(var t=function(e){if(!e)return!1;for(var t=0,r=n;t<r.length;t++){var c=r[t];if(e.search(c)!==-1)return!0}return!1};e.length>0&&t(e[0].func);)e=e.slice(1);return e}function assert(e,t,c){if(void 0===t&&(t="An assertion failed but no message was provided"),void 0===c&&(c={}),!e){var i=c.tags,l=void 0===i?[]:i,o=c.exc_extra,a=void 0===o?null:o;t="Assertion Error: "+t;try{throw new Error(t)}catch(e){var u=r.computeStackTrace(e);throw n._reportException({msg:t,stack:u&&null!=u.stack?u.stack:[],force:!0,tags:l.concat("module:exception","assert"),exc_extra:a}),e.reported=!0,f.forEach(function(e){return e(u)}),e}}}function reportStack(e,t){void 0===e&&(e="reportStack was called without a message"),void 0===t&&(t={}),t={severity:t.severity||n.SEVERITY.NONCRITICAL,tags:t.tags||[],exc_extra:t.exc_extra||{}};var r=new Error(e);n.reportException({err:r,force:!0,tags:(t.tags||[]).concat("module:exception","reportStack"),severity:t.severity,exc_extra:t.exc_extra})}var s=0,f=[],p=void 0;n.SEVERITY={CRITICAL:"critical",NONCRITICAL:"non-critical"},n.registerOnFailedAssert=a,n.reportException=reportException,n._reportException=_reportException,n.cleanup_stack_trace=u,n.assert=assert,n.reportStack=reportStack}),define("modules/core/exception_tag_registry",["require","exports"],function(e,n){"use strict";function t(){var e=[];for(var n in l)l.hasOwnProperty(n)&&e.push(n);return e}function r(e){l[e]=!0}function c(e){delete l[e]}function i(){l={}}var l={};n.get_registered_tags=t,n.register_tag=r,n.unregister_tag=c,n.clear_all_tags=i}),define("modules/pagelet_config",["require","exports","module"],function(e,n,t){"use strict";n.REQUIREJS_CONFIG=t.config().REQUIREJS_CONFIG}),function(){define("modules/shims/tracekit",["external/tracekit"],function(e){return e.linesOfContext=1,e.remoteFetching=!1,e.noConflict()})}.call(this);
//# sourceMappingURL=pkg-maestro-exception-reporting.min.js-vflhXPlso.map