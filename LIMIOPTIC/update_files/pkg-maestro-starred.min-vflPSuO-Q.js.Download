define("modules/clean/react/home/api",["require","exports","tslib","modules/clean/ajax","modules/clean/api_v2/client"],function(e,t,r,i,a){"use strict";var o=Promise.resolve({});t.makeRequest=function(e,t){void 0===t&&(t={});var a,s=function(a,o){(t.isBackground?i.SilentBackgroundRequest:i.WebRequest)(r.__assign({dataType:"json",success:a,error:function(e,t,r){return o(Error(r))}},e))};return t.useQueue?(a=new Promise(function(e,t){o.finally(function(){s(e,t)})}),o=a):a=new Promise(function(e,t){s(e,t)}),a},t.logHomeActivity=function(e){var r=e.entryType,i=e.eventName,a=e.extra,o=e.role;return Object.keys(a).forEach(function(e){return a[e]=String(a[e])}),t.makeRequest({url:"/home_feed/log_activity",type:"POST",data:{entry_type:r,event_name:i,extra:JSON.stringify(a),role:o}},{isBackground:!0})},t.setSectionVisibility=function(e,t,r){return(new a.ApiV2Client).rpc(e,"home/set_section_visibility",{section:t,visible:r})},t.createPaperDoc=function(e){return(new a.ApiV2Client).upload(e,"paper/docs/create",{import_format:"plain_text"},"")}}),define("modules/clean/react/home/starred/constants",["require","exports"],function(e,t){"use strict";t.StarredResourceActionTypes={LOADING_INITIAL:"HOME_STARRED_LOADING_INITIAL",LOADING_ALL:"HOME_STARRED_LOADING_ALL",LOAD_SUCCESS:"HOME_STARRED_LOAD_SUCCESS",LOAD_FAILURE:"HOME_STARRED_LOAD_FAILURE",HIDE_EMPTY_SECTION:"HOME_STARRED_HIDE_EMPTY_SECTION"},t.NOT_PAPER_USER_ERROR="not_paper_user",t.NUM_ACTIVITIES_PER_ITEM=5,t.StarredLoggingTypes={CLICK_STAR:"click_star",CLICK_UNSTAR:"click_unstar"}}),define("modules/clean/react/starred/actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/starred/constants","modules/clean/react/starred/api","modules/clean/react/starred/model"],function(e,t,r,i,a,o){"use strict";var s=(function(){function e(){}return e.fetchStatuses=function(e,t,s){return void 0===s&&(s=!1),s||r.dispatch({type:i.StarredActionTypes.LOADING,idTypePairs:t}),a.fetchStatuses(e,t).then(function(e){r.dispatch({type:i.StarredActionTypes.SET_STATUS,starredStatuses:o.statusResultsToStarredStatuses(e)})}).catch(function(e){return r.dispatch({type:i.StarredActionTypes.LOAD_FAILURE,idTypePairs:t}),Promise.reject(e)})},e.update=function(e,t,o,s){var n={id:t,type:o};r.dispatch({type:i.StarredActionTypes.LOADING,idTypePairs:[n]});var d,c=a.update(e,t,o,s);return c.then(function(){return d=s}).catch(function(e){throw d=!s,e}).finally(function(){r.dispatch({type:i.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:{id:t,type:o},starred:d}]})}),c},e})();t.StarredActions=s}),define("modules/clean/react/starred/api",["require","exports","modules/clean/ajax"],function(e,t,r){"use strict";var i=function(e,t){var i=function(i,a){r.WebRequest({url:e,type:"POST",dataType:"json",data:t,success:i,error:function(e,t,r){return a(Error(r))}})};return new Promise(function(e,t){i(e,t)})};t.fetchStatuses=function(e,t){return i("/starred/get_status",{role:e,resources_json:JSON.stringify(t)})},t.update=function(e,t,r,a){return i("/starred/update",{role:e,resource_id:t,id_type:r,is_starred:a})}}),define("modules/clean/react/starred/constants",["require","exports"],function(e,t){"use strict";t.StarredLoadingState={LOADING:"LOADING",LOAD_SUCCESS:"LOAD_SUCCESS",LOAD_FAILED:"LOAD_FAILED"},t.StarredActionTypes={LOADING:"STARRED_LOADING",SET_STATUS:"STARRED_SET_STATUS",LOAD_FAILURE:"STARRED_LOAD_FAILURE"},t.IdTypes={ENCODED_FILE_OBJ_ID:"ENCODED_FILE_OBJ_ID",PAPER_ID_PATH:"PAPER_ID_PATH"}}),define("modules/clean/react/starred/id_type_pair",["require","exports"],function(e,t){"use strict";function r(e){return e.type+":"+e.id}function i(e){return e.slice(e.indexOf(":")+1)}t.idTypePairToString=r,t.idFromIdTypePairString=i}),define("modules/clean/react/starred/model",["require","exports"],function(e,t){"use strict";function r(e){return e.map(function(e){var t=e.id,r=e.type,i=e.is_starred,a=e.canonical_id,o=e.canonical_id_type,s={idTypePair:{id:t,type:r},starred:i};return a&&o&&(s.canonicalIdTypePair={id:a,type:o}),s})}t.statusResultsToStarredStatuses=r}),define("modules/clean/react/starred/star",["require","exports","tslib","external/classnames","external/react","modules/clean/react/starred/starred_activity_logger","modules/clean/react/sprite","modules/clean/react/css","modules/clean/react/starred/actions","modules/clean/react/starred/store","modules/clean/react/title_bubble","modules/core/i18n","modules/core/notify"],function(e,t,r,i,a,o,s,n,d,c,u,p,S){"use strict";var l=(function(e){function t(t){var r=e.call(this,t)||this;return r.onStoreUpdate=function(){var e=r.getState();r.setState(e)},r.onClick=function(e){if(e.stopPropagation(),e.preventDefault(),r.props.overrides)return void r.props.overrides.onClick();if(!r.state.isLoading){var t=!r.state.isStarred;t?o.starredActivityLogger.logClickStar(r.props.id,r.props.idType,r.props.role):o.starredActivityLogger.logClickUnstar(r.props.id,r.props.idType,r.props.role),r.props.onStarClick&&r.props.onStarClick(t),d.StarredActions.update(r.props.role,r.props.id,r.props.idType,t).catch(function(e){var i;i=r.props.itemName?t?p._("There was a problem starring %(item_name)s").format({item_name:r.props.itemName}):p._("There was a problem unstarring %(item_name)s").format({item_name:r.props.itemName}):t?p._("There was a problem starring your selection"):p._("There was a problem unstarring your selection"),S.error(i)})}},r.state=r.getState(),r.removeStoreListener=c.StarredStore.addListener(r.onStoreUpdate),r.props.overrides&&(r.removeOverrideStoreListeners=r.props.overrides.getRemoveStoreListeners(r.onStoreUpdate)),r}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){this.removeStoreListener&&this.removeStoreListener(),this.removeOverrideStoreListeners&&this.removeOverrideStoreListeners()},t.prototype.getStateFromStore=function(){var e={id:this.props.id,type:this.props.idType};return{isLoading:c.StarredStore.getIsLoading(e),isStarred:c.StarredStore.getIsStarred(e)}},t.prototype.getState=function(){return this.props.overrides?this.props.overrides.getState():this.getStateFromStore()},t.prototype.getTooltipContent=function(){return this.state.isStarred?p._("Remove from Starred"):p._("Add to Starred")},t.prototype.render=function(){if(void 0===this.state.isStarred)return null;var e=this.state.isStarred||this.state.isLoading?"s_star":"s_unstar",t={star__toggle:!0,"star__toggle--starred":this.state.isStarred,"star__toggle--unstarred":!this.state.isStarred,"star__toggle--loading":this.state.isLoading,"u-pad-xs":!0};return a.createElement(u,{content:this.getTooltipContent(),position:this.props.tooltipPosition},a.createElement("button",{className:i(t),role:"button","aria-pressed":this.state.isStarred,"aria-label":"Star",onClick:this.onClick,onDoubleClick:this.onClick},a.createElement(s,{group:"web",name:e,alt:""})))},t})(a.PureComponent);l.displayName="Star",l.defaultProps={tooltipPosition:u.POSITIONS.TOP},t.Star=n(l,["/static/css/starred/star-vfllu-1vE.css"])}),define("modules/clean/react/starred/starred_activity_logger",["require","exports","modules/clean/react/home/api","modules/clean/react/home/starred/constants"],function(e,t,r,i){"use strict";var a=(function(){function e(){}return e.prototype.logClickStar=function(e,t,a){return r.logHomeActivity({eventName:i.StarredLoggingTypes.CLICK_STAR,role:a,extra:{resource_id:e,id_type:t}})},e.prototype.logClickUnstar=function(e,t,a){return r.logHomeActivity({eventName:i.StarredLoggingTypes.CLICK_UNSTAR,role:a,extra:{resource_id:e,id_type:t}})},e})();t.StarredActivityLogger=a,t.starredActivityLogger=new a}),define("modules/clean/react/starred/store",["require","exports","tslib","external/underscore","modules/clean/flux/dispatcher","modules/clean/flux/flux_store","modules/clean/react/starred/constants","modules/clean/react/home/starred/constants","modules/clean/react/starred/id_type_pair"],function(e,t,r,i,a,o,s,n,d){"use strict";var c=(function(e){function t(){var t=e.call(this,a)||this;return t.idsToLoadingState={},t.idsToStarred={},t}return r.__extends(t,e),t.prototype.getLoadingStates=function(){return this.idsToLoadingState},t.prototype.hasIdTypePair=function(e){return this.idsToLoadingState.hasOwnProperty(d.idTypePairToString(e))},t.prototype.getLoadingState=function(e){return this.idsToLoadingState[d.idTypePairToString(e)]},t.prototype.getIsStarred=function(e){return this.idsToStarred[d.idTypePairToString(e)]},t.prototype.getAllStarredPairStrings=function(){return i.keys(i.pick(this.idsToStarred,function(e){return e}))},t.prototype.getIsLoading=function(e){return this.getLoadingState(e)===s.StarredLoadingState.LOADING},t.prototype.onLoading=function(e){var t={};e.forEach(function(e){return t[d.idTypePairToString(e)]=s.StarredLoadingState.LOADING}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,t)},t.prototype.onSetStatus=function(e){void 0===e&&(e=[]);var t={},i={};e.forEach(function(e){var r=d.idTypePairToString(e.idTypePair);t[r]=s.StarredLoadingState.LOAD_SUCCESS,i[r]=e.starred}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,t),this.idsToStarred=r.__assign({},this.idsToStarred,i)},t.prototype.onLoadFailure=function(e){var t=this,i={};e.forEach(function(e){var r=d.idTypePairToString(e),a=t.idsToLoadingState[r];void 0!==a&&a!==s.StarredLoadingState.LOADING||(i[r]=s.StarredLoadingState.LOAD_FAILED)}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,i)},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case s.StarredActionTypes.LOADING:this.onLoading(t.idTypePairs);break;case s.StarredActionTypes.SET_STATUS:case n.StarredResourceActionTypes.LOAD_SUCCESS:this.onSetStatus(t.starredStatuses);break;case s.StarredActionTypes.LOAD_FAILURE:this.onLoadFailure(t.idTypePairs);break;default:return}this.__emitChange()},t})(o);t._StarredStoreClass=c,t.StarredStore=new c});
//# sourceMappingURL=pkg-maestro-starred.min.js-vflIfOfsu.map